<p>GcMultiRowコントロールでは、さまざまな方法でセルの値を取得できます。</p><p>MultiRowのセルにおいて、値は次のように処理されます。</p><ol><li><p><a href="gcdocsite__documentlink?toc-item-id=bf06962f-f1e4-4a56-86b0-d66989468cc4" title="">Cell.Value</a></p><p>Objectとしてセルの値を格納する。</p></li><li><p><a href="gcdocsite__documentlink?toc-item-id=344dc59e-d21f-4790-84a7-735cd8ca0770" title="">Cell.FormattedValue</a></p><p>セルの値をデータ型やスタイルに基づいて書式済みの値として変換する。</p></li><li><p><a href="gcdocsite__documentlink?toc-item-id=313bfba2-9577-4c25-8eb3-b6f5c91931dd" title="">Cell.DisplayText</a></p><p>書式済みの値を、各セル型の固有の設定に応じて表示用の値に変換する。</p></li></ol><p>セルの値（<a href="gcdocsite__documentlink?toc-item-id=bf06962f-f1e4-4a56-86b0-d66989468cc4" title="">Cell.Value</a>プロパティ）以外の値は読み取り専用です。</p><h2>セル値の設定／取得</h2><p>セルの値は<a href="gcdocsite__documentlink?toc-item-id=ac86d089-4114-4124-904b-b61de0fd0075" title="">GcMultiRow.SetValue</a>メソッドで設定します。次のコードは、１行目の２番目のセルに値を設定します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp">gcMultiRow1.SetValue(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-string">"ABC"</span>);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">GcMultiRow1.SetValue(0, 1, "ABC")</code></pre></div><p>セルの値を取得するには、<a href="gcdocsite__documentlink?toc-item-id=e95a7ab5-6850-4512-9546-5465c309b850" title="">GcMultiRow.GetValue</a>メソッドを使用します。次のコードは、１行目の２番目のセルの値を取得し、コンソールに出力します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-built_in">object</span> cellValue = gcMultiRow1.GetValue(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
Console.WriteLine(cellValue);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Dim cellValue As Object = GcMultiRow1.GetValue(0, 1)
Console.WriteLine(cellValue)</code></pre></div><p>次のように、行やセルのインスタンスを経由してセルの値を取得または設定することもできます。値の操作だけを目的とする場合は<a href="gcdocsite__documentlink?toc-item-id=e95a7ab5-6850-4512-9546-5465c309b850" title="">GcMultiRow.GetValue</a>メソッドおよび <a href="gcdocsite__documentlink?toc-item-id=ac86d089-4114-4124-904b-b61de0fd0075" title="">GcMultiRow.SetValue</a>メソッドの使用が推奨されます。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp">gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">1</span>].Value = <span class="hljs-string">"DEF"</span>;
gcMultiRow1[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>].Value = <span class="hljs-string">"GHI"</span>;
Console.WriteLine(gcMultiRow1[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>].Value);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">GcMultiRow1.Rows(0).Cells(1).Value = "DEF"
GcMultiRow1(0, 2).Value = "GHI"
Console.WriteLine(GcMultiRow1(0, 2).Value)</code></pre></div><p>セルの値は常にSystem.Object型です。これはセルの値のデータ型として、<a href="gcdocsite__documentlink?toc-item-id=c17e1def-c335-4b5f-bafa-3a2664531239" title="">Cell.ValueType</a>プロパティで確認できます。</p><h2>セルの書式指定済みの値の取得</h2><p>セルに関連付けられた書式指定済みの値を取得するには、<a href="gcdocsite__documentlink?toc-item-id=287af67d-bc85-461c-8a4c-be27de9368da" title="">GcMultiRow.GetFormattedValue</a>メソッドを使用します。次のコードは、1行目の2番目のセルの値を取得し、コンソールに出力します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-built_in">object</span> formattedValue = gcMultiRow1.GetFormattedValue(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
Console.WriteLine(formattedValue);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Dim formattedValue As Object = GcMultiRow1.GetFormattedValue(0, 1)
Console.WriteLine(formattedValue)</code></pre></div><p>次のように、行やセルのインスタンスを経由して書式指定済みの値を取得することもできます。値の取得だけを目的とする場合は<a href="gcdocsite__documentlink?toc-item-id=287af67d-bc85-461c-8a4c-be27de9368da" title="">GcMultiRow.GetFormattedValue</a>メソッドの使用が推奨されます。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-built_in">object</span> formattedValue = gcMultiRow1[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>].FormattedValue;
Console.WriteLine(formattedValue);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Dim formattedValue As Object = GcMultiRow1(0, 1).FormattedValue
Console.WriteLine(formattedValue)</code></pre></div><p>書式指定済みの値のデータ型は、<a href="gcdocsite__documentlink?toc-item-id=82063be6-e3e3-4747-b305-d67e59b015ef" title="">Cell.FormattedValueType</a>プロパティで取得できます。Cell.ValueTypeプロパティと異なり、<a href="gcdocsite__documentlink?toc-item-id=82063be6-e3e3-4747-b305-d67e59b015ef" title="">Cell.FormattedValueType</a>プロパティでは実際の表示に即したデータ型が返ります。たとえば、次のコードの結果は文字列型ではString、日付型ではDate(C#ではSystem.DateTime)になります。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp">Console.WriteLine(gcMultiRow1[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>].FormattedValueType);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Console.WriteLine(GcMultiRow1(0, 1).FormattedValueType)</code></pre></div><p>セルが編集中の場合や、値がコミットされていない状態のとき、セルの値は確定していないため、<a href="gcdocsite__documentlink?toc-item-id=344dc59e-d21f-4790-84a7-735cd8ca0770" title="">Cell.FormattedValue</a>プロパティでは最新の値を取得できない可能性があります。編集状態やコミットの有無に関係なく、セルの現在の書式指定済みの値を取得するには<a href="gcdocsite__documentlink?toc-item-id=1f542f28-534d-49e6-bdac-ab034649e122" title="">GcMultiRow.GetEditedFormattedValue</a>メソッドまたは<a href="gcdocsite__documentlink?toc-item-id=61759fc5-ef1f-4ea9-baa6-6a03a0a187fe" title="">Cell.EditedFormattedValue</a>プロパティを使用します。</p><p>セルの値の書式は<a href="gcdocsite__documentlink?toc-item-id=ee2e216d-b53e-4e2a-b380-9ce8f6f82194" title="">GcMultiRow.CellFormatting</a>イベントでカスタマイズできます。</p><h2>セルに表示されている値の取得</h2><p>セルに表示されている値を取得するには、<a href="gcdocsite__documentlink?toc-item-id=963af83c-e177-4594-82c9-a51fb051f2f3" title="">GcMultiRow.GetDisplayText</a>メソッドを使用します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-built_in">string</span> displayValue = gcMultiRow1.GetDisplayText(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
Console.WriteLine(displayValue);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Dim displayValue As String = GcMultiRow1.GetDisplayText(0, 1)
Console.WriteLine(displayValue)</code></pre></div><p>次のように、行やセルのインスタンスを経由してセルに表示されている値を取得することもできます。値の操作だけを目的とする場合は<a href="gcdocsite__documentlink?toc-item-id=963af83c-e177-4594-82c9-a51fb051f2f3" title="">GcMultiRow.GetDisplayText</a>メソッドの使用が推奨されます。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp">Console.WriteLine(gcMultiRow1[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>].DisplayText);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Console.WriteLine(GcMultiRow1(0, 2).DisplayText)</code></pre></div><p>セルの値は常に String 型です。</p><ul><li><p>チェックボックス型セルは常に<a href="gcdocsite__documentlink?toc-item-id=b012ec58-03fa-4076-bee6-688404adef04" title="">CheckBoxCell.Text</a>プロパティを返します。セルの値を返しません。</p></li><li><p>ラジオグループ型セルは選択されているアイテムの文字列を返します。もしアイテムが選択されていない場合は、String.Emptyを返します。</p></li><li><p>イメージ型セルとトラックバー型セルは常にString.Emptyを返します。</p></li></ul><h2>セル編集中の値の取得</h2><p>セルの編集中の値はSystem.Windows.Forms.Control.Textプロパティで取得します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-built_in">string</span> editingControlValue = gcMultiRow1.EditingControl.Text;
Console.WriteLine(editingControlValue);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Dim editingControlValue As String = GcMultiRow1.EditingControl.Text
Console.WriteLine(editingControlValue)</code></pre></div><h2>セルの既定値の取得</h2><p>行が新規に追加されたときのセルの既定値を取得するには、テンプレートのセルの値を参照します。</p><p>実行時に行を追加するタイミングでセルの既定値を設定するには<a href="gcdocsite__documentlink?toc-item-id=112a6112-2caf-4741-89db-56b5205c8239" title="">GcMultiRow.NewRowNeeded</a>イベントを使用します。</p><h2>列ヘッダセクションのセル値の取得／設定</h2><p>列ヘッダセクションに配置されたセルの値を取得するには、列ヘッダセクションやセルのインスタンスを経由してセルの値を取得または設定します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp">gcMultiRow1.ColumnHeaders[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">1</span>].Value = <span class="hljs-string">"ABC"</span>;
Console.WriteLine(gcMultiRow1.ColumnHeaders[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">2</span>].Value);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">GcMultiRow1.ColumnHeaders(0).Cells(1).Value = "ABC"
Console.WriteLine(GcMultiRow1.ColumnHeaders(0).Cells(2).Value)</code></pre></div><h2>関連トピック</h2><p><a href="gcdocsite__documentlink?toc-item-id=c96288bd-334e-4b75-8bfc-43dc6af17e13" title="">データの管理</a></p><p><a href="gcdocsite__documentlink?toc-item-id=9375cf8f-f355-41a8-a024-581534a3946e" title="">データの連結モード</a></p><p><a href="gcdocsite__documentlink?toc-item-id=2948cccd-4555-4304-b2de-0322638669c9" title="">データの並び替え</a></p><p><a href="gcdocsite__documentlink?toc-item-id=c7f1257c-84eb-494a-ad04-3506e5b696a9" title="">クリップボードの操作</a></p><p><a href="gcdocsite__documentlink?toc-item-id=bcb261f3-fa94-4023-b03a-7337535fe58a" title="">新しい行に既定値を設定</a></p>