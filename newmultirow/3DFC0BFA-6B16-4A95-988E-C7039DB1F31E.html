<p>GcCharMaskCellが提供する入力機能について解説します。</p><h2>書式の設定</h2><p>GcCharMaskCellは、<a href="gcdocsite__documentlink?toc-item-id=5b345432-8e85-417f-8588-be6375576dd1" title="">Format</a>プロパティにより書式を設定することで入力可能な文字種を制限することができます。また、<a href="gcdocsite__documentlink?toc-item-id=43b6442d-9208-468f-a6ec-a661a4de1f1f" title="">AutoConvert</a>プロパティを使用して指定の書式に自動的に変換することも可能です。</p><p>GcCharMaskCellに設定可能な文字種等の詳細については、「<a href="gcdocsite__documentlink?toc-item-id=649aebdc-59be-4cdb-8e7b-651617976a20" title="">書式の設定</a>」で解説します。</p><h2>入力方向の設定</h2><p>GcCharMaskCell では、<a href="gcdocsite__documentlink?toc-item-id=0a0454a9-da68-4e4f-8ae6-2cb445f86e00" title="">InputDirection</a>プロパティを使って、テキストの入力方向を設定することができます。セルへの入力内容に応じてテキストの入力方向を設定することで、自然な入力を実現することができます。</p><p>たとえば、文字列や番号のような入力の場合、<a href="gcdocsite__documentlink?toc-item-id=0985604e-a1cd-4f83-a7b5-a89ac8e6c6ec" title="">CharMaskInputDirection.LeftToRight</a>（左から右へ）、数値や金額などを入力する場合は<a href="gcdocsite__documentlink?toc-item-id=0985604e-a1cd-4f83-a7b5-a89ac8e6c6ec" title="">CharMaskInputDirection.RightToLeft</a>（右から左へ）のように設定することができます。</p><ul><li><p>InputDirection.<strong>LeftToRight</strong> の例</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/imimages/03gccharmask/righttoleft_no1.png" contenteditable="false"> → <img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/imimages/03gccharmask/righttoleft_no2.png" contenteditable="false"> → <img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/imimages/03gccharmask/righttoleft_no3.png" contenteditable="false"><br></p></li><li><p>InputDirection.<strong>RightToLeft</strong> の例</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/imimages/03gccharmask/righttoleft_yes1.png" contenteditable="false"> → <img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/imimages/03gccharmask/righttoleft_yes2.png" contenteditable="false"> → <img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/imimages/03gccharmask/righttoleft_yes3.png" contenteditable="false"><br></p></li></ul><p>次のサンプルコードは、入力方向を右から左に設定する例です。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.MultiRow;
<span class="hljs-keyword">using</span> InputManCell = GrapeCity.Win.MultiRow.InputMan;

InputManCell.GcCharMaskCell gcCharMaskCell1 = <span class="hljs-keyword">new</span> InputManCell.GcCharMaskCell();
gcCharMaskCell1.Name = <span class="hljs-string">"gcCharMaskCell1"</span>;
gcCharMaskCell1.InputDirection = GrapeCity.Win.Editors.CharMaskInputDirection.RightToLeft;

gcMultiRow1.Template = Template.CreateGridTemplate(<span class="hljs-keyword">new</span> Cell[] { gcCharMaskCell1 });</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.MultiRow
Imports InputManCell = GrapeCity.Win.MultiRow.InputMan

Dim GcCharMaskCell1 As New InputManCell.GcCharMaskCell()
GcCharMaskCell1.Name = "GcCharMaskCell1"
GcCharMaskCell1.InputDirection = GrapeCity.Win.Editors.CharMaskInputDirection.RightToLeft

GcMultiRow1.Template = Template.CreateGridTemplate(New Cell() {GcCharMaskCell1})</code></pre></div><h2>改行コードの取り扱い</h2><p><a href="gcdocsite__documentlink?toc-item-id=ed72ba35-bd80-4205-bc3b-c391af152299" title="">AcceptsCrLf</a>プロパティを使用してクリップボードへ改行を含む文字列をコピー、または貼り付けた場合の改行コードの扱いを設定できます。AcceptsCrLfプロパティは、<a href="gcdocsite__documentlink?toc-item-id=b22d2b62-d37b-456c-a018-f94ad093f564" title="">CrLfMode</a> 列挙体を使用して次の値を設定できます。</p><table><thead><tr><th><p>AcceptsCrLfの値</p></th><th><p>説明</p></th></tr></thead><tbody><tr><td><p>NoControl</p></td><td><p>改行コードはそのままでコピー、貼り付けを行います。</p></td></tr><tr><td><p>Filter</p></td><td><p>全ての改行コードを削除しコピー、貼り付けを行います。</p></td></tr><tr><td><p>Cut</p></td><td><p>最初の改行コード以降の文字列を削除します。標準コントロールと同じ動作です。</p></td></tr></tbody></table><h2>値の取得と設定</h2><p><a href="gcdocsite__documentlink?toc-item-id=bf06962f-f1e4-4a56-86b0-d66989468cc4" title="">Value</a>プロパティを使えば、リテラル文字列とプロンプト文字列を除いたセル内の文字列を取得または設定できます。たとえば、セルに「郵便番号：981-3205」が設定されているときには、Valueプロパティの値は「9813205」となります。</p><p>クリップボードにリテラル文字を含まない値を渡すには、<a href="gcdocsite__documentlink?toc-item-id=7048ee28-c526-4c8e-aa1f-ca087019022b" title="">ClipContent</a>プロパティと GcCharMaskEditingControl.SelectedTextプロパティを使用します。ClipContentプロパティで制御できるのは、SelectedTextプロパティの値のみです。なお、プロンプト文字列は、ClipContentプロパティの設定に関わらず常にクリップボードに渡されます。</p><p>次のサンプルコードは、ClipContentプロパティを使って、リテラル文字列を省いた文字列をクリップボードにコピーする方法を示します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.MultiRow;
<span class="hljs-keyword">using</span> InputManCell = GrapeCity.Win.MultiRow.InputMan;

<span class="hljs-function">private void Form1_Load(object sender, EventArgs e)</span>
{
    InputManCell.GcCharMaskCell gcCharMaskCell1 = <span class="hljs-keyword">new</span> InputManCell.GcCharMaskCell();
    <span class="hljs-comment">// マス目をクリアします。 </span>
    gcCharMaskCell1.CharBoxes.Clear();
    <span class="hljs-comment">// 書式を設定します。 </span>
    gcCharMaskCell1.Format = <span class="hljs-string">"9"</span>;
    <span class="hljs-comment">// 郵便番号用のマス目を設定します。 </span>
    gcCharMaskCell1.CharBoxes.Add(<span class="hljs-keyword">new</span> InputManCell.LiteralBox(<span class="hljs-string">"〒"</span>));
    gcCharMaskCell1.CharBoxes.Add(<span class="hljs-keyword">new</span> InputManCell.InputBox());
    gcCharMaskCell1.CharBoxes.Add(<span class="hljs-keyword">new</span> InputManCell.InputBox());
    gcCharMaskCell1.CharBoxes.Add(<span class="hljs-keyword">new</span> InputManCell.InputBox());
    gcCharMaskCell1.CharBoxes.Add(<span class="hljs-keyword">new</span> InputManCell.SeparatorBox());
    gcCharMaskCell1.CharBoxes.Add(<span class="hljs-keyword">new</span> InputManCell.InputBox());
    gcCharMaskCell1.CharBoxes.Add(<span class="hljs-keyword">new</span> InputManCell.InputBox());
    gcCharMaskCell1.CharBoxes.Add(<span class="hljs-keyword">new</span> InputManCell.InputBox());
    gcCharMaskCell1.CharBoxes.Add(<span class="hljs-keyword">new</span> InputManCell.InputBox());
    gcCharMaskCell1.Value = <span class="hljs-string">"9813205"</span>;
    gcCharMaskCell1.ClipContent = GrapeCity.Win.Editors.ClipContent.ExcludeLiterals;

    TextBoxCell textBoxCell1 = <span class="hljs-keyword">new</span> TextBoxCell();

    <span class="hljs-comment">// MultiRowのテンプレートを設定します。 </span>
    gcMultiRow1.Template = Template.CreateGridTemplate(<span class="hljs-keyword">new</span> Cell[] { gcCharMaskCell1, textBoxCell1 });
    gcMultiRow1.RowCount = <span class="hljs-number">5</span>;

    gcMultiRow1.EditingControlShowing += <span class="hljs-keyword">new</span> EventHandler&lt;EditingControlShowingEventArgs&gt;(gcMultiRow1_EditingControlShowing);
}

<span class="hljs-function">private void gcMultiRow1_EditingControlShowing(object sender, EditingControlShowingEventArgs e)</span>
{
    <span class="hljs-keyword">if</span> (e.Control <span class="hljs-keyword">is</span> InputManCell.GcCharMaskEditingControl)
    {
        <span class="hljs-comment">// GcCharMaskCellの編集用コントロールが表示された場合にKeyDownイベントを設定します。 </span>
        e.Control.KeyDown -= <span class="hljs-keyword">new</span> KeyEventHandler(Editor_KeyDown);
        e.Control.KeyDown += <span class="hljs-keyword">new</span> KeyEventHandler(Editor_KeyDown);
    }
}

<span class="hljs-function">private void Editor_KeyDown(object sender, KeyEventArgs e)</span>
{
    Cell cell = gcMultiRow1.CurrentCell;

    <span class="hljs-keyword">if</span> (e.KeyCode == Keys.F5)
    {
        InputManCell.GcCharMaskEditingControl editor = (InputManCell.GcCharMaskEditingControl)sender;

        <span class="hljs-comment">// クリップボードにコピーします。  </span>
        editor.SelectionStart = <span class="hljs-number">0</span>;
        editor.SelectionLength = editor.Text.Length;
        Clipboard.SetDataObject(editor.SelectedText);

        <span class="hljs-comment">// クリップボードのデータを取得して確認します。  </span>
        IDataObject cbData = Clipboard.GetDataObject();
        gcMultiRow1[cell.RowIndex, cell.CellIndex + <span class="hljs-number">1</span>].Value = cbData.GetData(DataFormats.Text).ToString();
    }
}</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.MultiRow
Imports InputManCell = GrapeCity.Win.MultiRow.InputMan

Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    Dim GcCharMaskCell1 = New InputManCell.GcCharMaskCell()
    ' マス目をクリアします。 
    GcCharMaskCell1.CharBoxes.Clear()
    ' 書式を設定します。 
    GcCharMaskCell1.Format = "9"
    ' 郵便番号用のマス目を設定します。 
    GcCharMaskCell1.CharBoxes.Add(New InputManCell.LiteralBox("〒"))
    GcCharMaskCell1.CharBoxes.Add(New InputManCell.InputBox())
    GcCharMaskCell1.CharBoxes.Add(New InputManCell.InputBox())
    GcCharMaskCell1.CharBoxes.Add(New InputManCell.InputBox())
    GcCharMaskCell1.CharBoxes.Add(New InputManCell.SeparatorBox())
    GcCharMaskCell1.CharBoxes.Add(New InputManCell.InputBox())
    GcCharMaskCell1.CharBoxes.Add(New InputManCell.InputBox())
    GcCharMaskCell1.CharBoxes.Add(New InputManCell.InputBox())
    GcCharMaskCell1.CharBoxes.Add(New InputManCell.InputBox())
    GcCharMaskCell1.Value = "9813205"
    GcCharMaskCell1.ClipContent = GrapeCity.Win.Editors.ClipContent.ExcludeLiterals

    Dim TextBoxCell1 As New TextBoxCell()

    ' MultiRowのテンプレートを設定します。  
    GcMultiRow1.Template = Template.CreateGridTemplate(New Cell() {GcCharMaskCell1, TextBoxCell1})
    GcMultiRow1.RowCount = 5
End Sub

Private Sub GcMultiRow1_EditingControlShowing(sender As Object, e As EditingControlShowingEventArgs) Handles GcMultiRow1.EditingControlShowing
    If TypeOf e.Control Is InputManCell.GcCharMaskEditingControl Then
        ' GcCharMaskCellの編集用コントロールが表示された場合にKeyDownイベントを設定します。  
        RemoveHandler e.Control.KeyDown, AddressOf Editor_KeyDown
        AddHandler e.Control.KeyDown, AddressOf Editor_KeyDown
    End If
End Sub

Private Sub Editor_KeyDown(sender As Object, e As System.Windows.Forms.KeyEventArgs)

    Dim cell As Cell = GcMultiRow1.CurrentCell

    If e.KeyCode = Keys.F5 Then
        Dim editor As InputManCell.GcCharMaskEditingControl = DirectCast(sender, InputManCell.GcCharMaskEditingControl)

        ' クリップボードにコピーします。  
        editor.SelectionStart = 0
        editor.SelectionLength = editor.Text.Length
        Clipboard.SetDataObject(editor.SelectedText)

        ' クリップボードのデータを取得して確認します。  
        Dim cbData As IDataObject = Clipboard.GetDataObject()
        GcMultiRow1(cell.RowIndex, cell.CellIndex + 1).Value = cbData.GetData(DataFormats.Text).ToString()
    End If
End Sub</code></pre></div><h2>自動フォーカス移動</h2><p><a href="gcdocsite__documentlink?toc-item-id=1901a2de-5014-48b3-9be7-45fc9aa187b3" title="">ExitOnLastChar</a>プロパティをTrueに設定すると、入力された文字列が、<a href="gcdocsite__documentlink?toc-item-id=df896e49-3dab-41a6-b0f7-2fc14876402f" title="">CharBoxes</a>プロパティで設定した最大文字数に達したときに、自動的に次のコントロールへフォーカスを移動できます。</p><h2>関連トピック</h2><p><a href="gcdocsite__documentlink?toc-item-id=6213468d-8383-4747-9da7-55c8cdc02946" title="">GcCharMaskCell</a></p><p><a href="gcdocsite__documentlink?toc-item-id=649aebdc-59be-4cdb-8e7b-651617976a20" title="">書式の設定</a></p><p><a href="gcdocsite__documentlink?toc-item-id=67882c89-6124-435d-a8b3-cd5bfe95796f" title="">マス目の設定</a></p><p><a href="gcdocsite__documentlink?toc-item-id=ad3eae02-d613-45bd-93ed-18e46c0bbcba" title="">視覚的な補助</a></p><p><a href="gcdocsite__documentlink?toc-item-id=8df94c76-b7d6-4897-ae89-73b5e0127018" title="">外観の設定</a></p><p><a href="gcdocsite__documentlink?toc-item-id=ee3d6383-1642-4d0c-963e-f01192324109" title="">データベース接続</a></p>