<p>MultiRowは、.NET Frameworkの標準コントロールと同じようにADO.NETを使用してデータベースに接続できます。</p><h2>データベースの接続</h2><p>SQL Serverのデータソースをプロジェクトに登録します。この作業はMultiRowに依存しません。</p><ol><li><p>Visual Studioを起動して、新規にWindows Application プロジェクトを作成する。</p></li><li><p>Visual Studioの［プロジェクト］－［新しいデfータソースの追加］メニューをクリックする。</p></li><li><p>表示された「データ ソース構成ウィザード」の画面で、「データベース」を選択し、［次へ］をクリックする。</p></li><li><p>表示された「データ接続の選択」画面で、［新しい接続］をクリックし次の構成で接続を追加する。</p><ul><li><p>データソース：Microsoft SQL Server (SqlClient)</p></li><li><p>サーバー名(例)：(local)\SQLEXPRESS</p></li><li><p>データベースの選択または入力：AdventureWorks2012</p></li></ul><blockquote type="warning"><p>!type=warning</p><p><br></p><p>「<img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/web.png" alt="Web サイト" contenteditable="false"> <a href="https://msdn.microsoft.com/ja-jp/library/aa992075.aspx" title="">チュートリアル: AdventureWorks データベースのインストール</a>」を参考にサンプルデータベースをダウンロードしてください。</p></blockquote></li><li><p>接続を追加した後、［次へ］をクリックする。</p></li><li><p>「接続文字列をアプリケーション構成ファイルに保存する」画面で［次へ］をクリックする。</p></li><li><p>「データベース オブジェクトの選択」画面で、次の2つのテーブルのチェックをオンにする。</p><ul><li><p>Employee</p></li><li><p>Person</p></li></ul></li><li><p>［完了］をクリックする。</p></li><li><p>Visual Studioの「データソース」ウィンドウに「Employee」と「Person」が追加されていることを確認する。</p></li></ol><h2>テンプレートの設計</h2><p>MultiRowのテンプレートを作成し、テーブルのフィールドを割り当てます。</p><ol><li><p>Visual Studioの［プロジェクト］－［新しい項目の追加］メニューをクリックする。</p></li><li><p>「新しい項目の追加」画面で、「MultiRow 12.0 テンプレート」を選択し、［追加］ボタンをクリックする。</p></li><li><p>「Template1.cs デザイン」画面が表示されることを確認する。</p></li><li><p>次の構成で列ヘッダを作成する。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/databinding_01.png" alt="作成する列ヘッダ" contenteditable="false"><br></p><ol><li><p>「ツールボックス」ウィンドウから、ColumnHeaderCellをColumnHeaderSection1にドラッグする（4回繰り返す）。</p></li><li><p>ドラッグしたセルのValueプロパティに「ID」「LastName」「PersonType」「JobTitle」を設定する。</p></li><li><p>columnHeaderSection1の高さをセルの高さに合わせる。</p></li></ol></li><li><p>次の構成で行を作成する。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/databinding_02.png" alt="作成する行" contenteditable="false"><br></p><ol><li><p>「ツールボックス」ウィンドウから、RowHeaderCellをrow にドラッグする。</p></li><li><p>「ツールボックス」ウィンドウから、TextBoxCellをrowにドラッグする（2回繰り返す）。</p></li><li><p>「ツールボックス」ウィンドウから、ComboBoxCellをrowにドラッグする。</p></li><li><p>ComboBoxCellのDropDownStyleプロパティにDropDownを設定する。</p></li><li><p>ドラッグしたセルのDataFieldプロパティに「BusinessEntityID」「LastName」「PersonType」を設定する。（ComboBoxCellのDataFieldプロパティは空のまま）</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/databinding_03.png" alt="行のセルに対するデータフィールドの割り当て" contenteditable="false"><br></p></li><li><p>rowの高さをセルの高さに合わせる。</p></li></ol></li><li><p>テンプレートの幅をセルの幅に合わせる。</p></li><li><p>プロジェクトを保存する。</p></li></ol><h2>グリッドへの接続</h2><p>フォームにGcMultiRowコントロールを配置して、データソースとテンプレートをグリッドに割り当てます。</p><ol><li><p>フォーム（Form1）のデザイン画面を開く。</p></li><li><p>「データソース」ウィンドウから「Person」テーブルを選択し、ドロップダウンリストから「カスタマイズ...」をクリックする。</p></li><li><p>表示された「オプション」画面で「関連付けられたコントロール」の「GcMultiRow」のチェックをオンにする。</p></li><li><p>［OK］ボタンをクリックしてダイアログを閉じる。</p></li><li><p>「データソース」ウィンドウから「Person」テーブルを選択し、ドロップダウンリストから「GcMultiRow」をクリックする。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/databinding_04.png" alt="ドロップダウンリストから「GcMultiRow」をクリックする" contenteditable="false"><br></p></li><li><p>「Person」テーブルをフォーム（Form1）のデザイン画面にドラッグ＆ドロップする。</p></li><li><p>フォームにBindingNavigator(personBindingNavigator)とGcMultiRow(personGcMultiRow)が配置されることを確認する。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/databinding_05.png" alt="ordersBindingNavigator と ordersGcMultiRow" contenteditable="false"><br></p></li><li><p>Visual Studioの［ビルド］－［ソリューションのビルド］メニューをクリックする。</p></li><li><p>「ツールボックス」ウィンドウから「Template1」をフォームにドラッグ＆ドロップする。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/databinding_06.png" alt="Template1 クラスのインスタンス" contenteditable="false"><br></p></li><li><p>フォーム上のpersonGcMultiRowコントロールを選択し、スマートタグから「テンプレートの選択」で「template11」を選択する。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/databinding_07.png" alt="GcMultiRow コントロールのスマートタグ" contenteditable="false"><br></p></li></ol><p>以上でグリッドへのテンプレートとデータソースの割り当ては完了です。プロジェクトを実行すると、データソースの値がグリッドに読み込まれます。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/databinding_08.png" alt="プロジェクトの実行結果" contenteditable="false"><br></p><h2>ルックアップ列の設定</h2><p>PersonテーブルのBusinessEntityID列の値は、EmployeeテーブルのBusinessEntityID列の値と同じです。このBusinessEntityID列の値を元に、EmployeeテーブルのJobTitle列の値を列挙します。</p><ol><li><p>「データソース」ウィンドウから「Employee」テーブルを選択し、フォーム（Form1）のデザイン画面にドラッグ＆ドロップする。</p></li><li><p>フォーム上に配置されるDataGirdViewコントロールを削除する。</p></li><li><p>フォームのコードエディタを開き、次のコードを貼り付ける。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.MultiRow;

<span class="hljs-function">private void Form1_Load(object sender, EventArgs e)</span>
{

    Template1 myTemplate = <span class="hljs-keyword">new</span> Template1();    
    ComboBoxCell comboBoxCell = myTemplate.Row[<span class="hljs-string">"comboBoxCell1"</span>] <span class="hljs-keyword">as</span> ComboBoxCell;    
    comboBoxCell.DataSource = <span class="hljs-keyword">this</span>.employeeBindingSource;    
    comboBoxCell.DisplayMember = <span class="hljs-string">"JobTitle"</span>;    
    comboBoxCell.ValueMember = <span class="hljs-string">"BusinessEntityID"</span>;    
    comboBoxCell.DataField = <span class="hljs-string">"BusinessEntityID"</span>;    
    <span class="hljs-keyword">this</span>.personGcMultiRow.Template = myTemplate;

<span class="hljs-comment">// TODO: このコード行はデータを 'adventureWorks2012DataSet.Employee' テーブルに読み込みます。必要に応じて移動、または削除をしてください。    this.employeeTableAdapter.Fill(this.adventureWorks2012DataSet.Employee);    </span>
<span class="hljs-comment">// TODO: このコード行はデータを 'adventureWorks2012DataSet.Person' テーブルに読み込みます。必要に応じて移動、または削除をしてください。    this.personTableAdapter.Fill(this.adventureWorks2012DataSet.Person);</span>
}</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.MultiRow

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs)

    Dim myTemplate As New Template1()    
    Dim ComboBoxCell = DirectCast(myTemplate.Row("ComboBoxCell1"), ComboBoxCell)    
    ComboBoxCell.DataSource = Me.EmployeeBindingSource    
    ComboBoxCell.DisplayMember = "JobTitle"    
    ComboBoxCell.ValueMember = "BusinessEntityID"    
    ComboBoxCell.DataField = "BusinessEntityID"    
    Me.PersonGcMultiRow.Template = myTemplate

    'TODO: このコード行はデータを 'AdventureWorks2012DataSet.Employee' テーブルに読み込みます。必要に応じて移動、または削除をしてください。    Me.EmployeeTableAdapter.Fill(Me.AdventureWorks2012DataSet.Employee)    
    'TODO: このコード行はデータを 'AdventureWorks2012DataSet.Person' テーブルに読み込みます。必要に応じて移動、または削除をしてください。    Me.PersonTableAdapter.Fill(Me.AdventureWorks2012DataSet.Person)
End Sub</code></pre></div></li></ol><p>プロジェクトを実行すると、ComboBoxCellにJobTitle列の値が列挙されることを確認できます。</p><h2>関連トピック</h2><p><a href="gcdocsite__documentlink?toc-item-id=1a43c0f3-3afa-4eaf-bbfe-74fe65202e0b" title="">MultiRowの使い方</a></p>