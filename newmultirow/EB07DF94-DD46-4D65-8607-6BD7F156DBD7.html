<p>セルでは、ImeModeプロパティまたはInputScopeプロパティを使用して、IMEモードを設定することができます。ここでは、IMEモードの設定について説明します。</p><h2>IMEモードについて</h2><p><a href="gcdocsite__documentlink?toc-item-id=5dc1e701-3ee0-4f17-a9c8-cb6f0e72965a" title="">CellStyle.ImeMode</a>プロパティと<a href="gcdocsite__documentlink?toc-item-id=cafa1bb6-ed88-458c-b6c0-96d0a27c4705" title="">CellStyle.ImeSentenceMode</a>プロパティを使用すると、標準コントロールと同じ入力モードの設定に加えて、変換モードの設定を利用できます。</p><h4>入力モード</h4><p>セルは標準コントロールと同じIME入力モードをサポートしています。IME入力モードの設定値はSystem.Windows.Forms.ImeModeと同じです。たとえば、次のモードを使用できます。</p><ul><li><p>ひらがな</p></li><li><p>全角カタカナ</p></li><li><p>全角英数</p></li><li><p>半角カタカナ</p></li><li><p>半角英数</p></li></ul><p>セルのIME入力モードは、<a href="gcdocsite__documentlink?toc-item-id=5dc1e701-3ee0-4f17-a9c8-cb6f0e72965a" title="">CellStyle.ImeMode</a>プロパティで設定します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp">gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.ImeMode = ImeMode.Hiragana;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">GcMultiRow1.Rows(0).Cells(0).Style.ImeMode = ImeMode.Hiragana</code></pre></div><h4>変換モード</h4><p>変換モードは、IMEによって提供されるかな漢字変換の動作モードです。たとえば、変換時に文字列を人名・地名に優先的にマッチさせることができます。サポートされる変換モードは次のとおりです。</p><ul><li><p>一般</p></li><li><p>人名/地名</p></li><li><p>話し言葉優先</p></li><li><p>無変換</p></li><li><p>継承</p></li><li><p>なし</p></li></ul><p>セルのIME変換モードは、<a href="gcdocsite__documentlink?toc-item-id=cafa1bb6-ed88-458c-b6c0-96d0a27c4705" title="">CellStyle.ImeSentenceMode</a>プロパティで設定します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.MultiRow;

gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.ImeMode = ImeMode.Hiragana;
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.ImeSentenceMode = ImeSentenceMode.BiasForNames;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.MultiRow

GcMultiRow1.Rows(0).Cells(0).Style.ImeMode = ImeMode.Hiragana
GcMultiRow1.Rows(0).Cells(0).Style.ImeSentenceMode = ImeSentenceMode.BiasForNames</code></pre></div><h2>IMEモードとInputScopeプロパティ</h2><p>Windows7以前のOSではIMEモードがスレッド単位で保持されていましたが、Windows 8以降ではユーザー単位で保持されるように仕様が変更されています。この変更によって、ImeModeプロパティによるIMEモードの切り替えが動作しない場合があります。</p><p>Windows 8以降の環境において、Windows 7以前のOSと同じようにIMEモードをスレッド単位で保持するには、以下の手順で「アプリ ウィンドウごとに異なる入力方式を設定する」の設定を変更します。</p><ol><li><p>コントロールパネルを開き、「時計、言語、および地域」から「言語」-「詳細設定」をクリックします。</p></li><li><p>「入力方式の切り替え」グループの「アプリ ウィンドウごとに異なる入力方式を設定する」をオンにします。</p></li><li><p>「保存」ボタンをクリックして設定を有効にします。</p></li></ol><p>なお、InputScopeプロパティを使用することで上記の設定なしでWindows 7以前のOSと同じようにIMEモードを制御することができます。</p><h2>InputScope プロパティの使い方</h2><p><a href="gcdocsite__documentlink?toc-item-id=ee02dd44-4c8d-4831-a26f-5e4de221f2a0" title="">CellStyle.InputScope</a>プロパティを使用すると、Windows 8以降の環境でも、Windows 7以前のOSと同じようにIMEモードを制御することができます。</p><p>MultiRowにおけるInputScopeプロパティとImeModeプロパティの挙動の差異は現在のところ確認されていませんが、InputScopeプロパティの動作はText Services FrameworkのSetInputScope関数に依存した動作となり、ImeModeプロパティとは異なる内部構造で動作するプロパティとなるため、Windows 8以降のOSにおいてIMEモードをWindows 7以前の動作と全く同じ挙動にしたい場合は、上記OSの設定値（「アプリ ウィンドウごとに異なる入力方式を設定する」）を変更することを推奨します。</p><p>ただし、セルに<a href="gcdocsite__documentlink?toc-item-id=5dc1e701-3ee0-4f17-a9c8-cb6f0e72965a" title="">CellStyle.ImeMode</a>プロパティと<a href="gcdocsite__documentlink?toc-item-id=ee02dd44-4c8d-4831-a26f-5e4de221f2a0" title="">CellStyle.InputScope</a>プロパティの両方が変更されている場合、InputScopeプロパティの設定が優先されます。ImeModeプロパティの設定を優先したい場合は、InputScopeプロパティをDefaultに設定する必要があります。</p><p>次のコードでは、InputScopeプロパティを使用して、セルのIME入力モードを設定します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp">gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.InputScope = GrapeCity.Win.MultiRow.InputScopeNameValue.Hiragana;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">GcMultiRow1.Rows(0).Cells(0).Style.InputScope = GrapeCity.Win.MultiRow.InputScopeNameValue.Hiraganas</code></pre></div><blockquote type="warning"><p>!type=warning</p><ul><li><p>InputScopeプロパティはタッチ キーボードに影響します。たとえばInputScopeプロパティでIMEモードを全角英数にしたとき、タッチ キーボードを表示するとそのキーボード レイアウトが英数になります。</p></li><li><p>InputScopeプロパティで全角カタカナ、半角カタカナおよび全角英数を使用するとき、タッチ キーボードにはこれらに対応するレイアウトが提供されないため、タッチ キーボードのレイアウトは切り替わりません。タッチキーボードからこれらの文字を入力する場合には変換候補から選択して入力します。</p></li><li><p>InputScopeプロパティの動作はText Services FrameworkのSetInputScope関数に依存しています。</p></li></ul></blockquote><h2>関連トピック</h2><p><a href="gcdocsite__documentlink?toc-item-id=0659dda6-b828-4148-a42a-71244a85690c" title="">セルのスタイル</a></p><p><a href="gcdocsite__documentlink?toc-item-id=7bd4c3f5-3a4b-47d1-a04d-c6b0eb34b77e" title="">スタイルの適用ルール</a></p><p><a href="gcdocsite__documentlink?toc-item-id=1f3aedd3-7f2e-404f-9b1c-a035fb3a0028" title="">罫線</a></p><p><a href="gcdocsite__documentlink?toc-item-id=659c8f82-913c-4151-ac57-5489df055fff" title="">背景色と前景色</a></p><p><a href="gcdocsite__documentlink?toc-item-id=890081a2-3af9-4359-8697-d49b65dfe284" title="">背景パターン</a></p><p><a href="gcdocsite__documentlink?toc-item-id=2e54d2f0-6317-4fce-a74e-8b763f3f2f10" title="">背景グラデーション</a></p><p><a href="gcdocsite__documentlink?toc-item-id=fb73f7b0-aae0-43fa-aacd-4a74f84fa16a" title="">タグ</a></p><p><a href="gcdocsite__documentlink?toc-item-id=7ccdf46e-326e-4f4f-a097-051ad2700b6e" title="">イメージ</a></p><p><a href="gcdocsite__documentlink?toc-item-id=a9f06eec-b225-4b07-826e-f14a1e77d6ca" title="">マージンとパディング</a></p><p><a href="gcdocsite__documentlink?toc-item-id=b113b6cb-598e-48a9-917e-8eec48db994b" title="">複数行とワードラップ</a></p><p><a href="gcdocsite__documentlink?toc-item-id=e32f062a-3075-439c-a2f2-3c7a07840510" title="">文字書式</a></p><p><a href="gcdocsite__documentlink?toc-item-id=122eb1b4-e5f2-48d3-ab7c-a0249190a034" title="">テキストのインデント</a></p><p><a href="gcdocsite__documentlink?toc-item-id=9b34fee2-3101-44f6-8e71-6cd80cca6a4d" title="">GDI+互換モード</a></p><p><a href="gcdocsite__documentlink?toc-item-id=048b62a5-4dee-44f2-85de-b20c61c8c644" title="">マウスホバーのスタイル</a></p><p><a href="gcdocsite__documentlink?toc-item-id=1e2c91d2-750e-44f1-bc8f-05d6c9729caf" title="">ユーザー定義のワードラップ</a></p><p><a href="gcdocsite__documentlink?toc-item-id=5a7efb6e-2090-42a0-b4ca-026b541f2de9" title="">半角文字の均等割付のカスタマイズ</a></p>