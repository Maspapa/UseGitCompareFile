ランタイム ファイルの配布方法には、製品に付属するWindowsインストーラ ブートストラッパを使用する方法とランタイム ファイルを直接コピーする方法の2種類があります。

## ブートストラッパを使用したランタイム ファイルの配布（推奨）

ブートストラッパ（bootstrapper）とは、アプリケーションのインストールの前にそのアプリケーションの実行に必要なランタイム ファイルをインストールするインストーラの総称です。MultiRowがインストールされた開発環境には、MultiRow専用のランタイムブートストラッパが用意されており、セットアップ プロジェクトまたはClickOnceへ簡単に組み込むことが可能です。

> !type=warning
>
> * MultiRow for Windows Forms 12.0Jのブートストラッパでは、InputManCellを使用するために必要なInputMan for Windows Forms 12.0Jのランタイムファイルも配布します。
> * MultiRow for Windows Forms 12.0Jのブートストラッパでは、PlusPakCellを使用するために必要なPlusPak for Windows Forms 12.0Jのランタイムファイルも配布します。

## インストーラへのブートストラッパの組み込み

1. セットアッププロジェクトをVisual Studioで開き、〈プロジェクト〉メニューから〈プロパティ〉を表示します。
2. 「公開」タブをクリックします。
3. 〈必須コンポーネント〉ボタンをクリックし、必須コンポーネントのリストにある「MultiRow for Windows Forms Runtime 12.0.yyyy.mmdd」にチェックを入れます。
    ![](/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/welcome/introducing_redistributionhowto_01.png)
4. 必須コンポーネントのインストール場所を指定します。「必須コンポーネントをコンポーネントの開発元のWebサイトからダウンロードする」にすると、セットアップ起動時に開発元のWebサイトからランタイムのブートストラッパをダウンロードします。「アプリケーションと同じ場所から必須コンポーネントをダウンロードする」にすると、プロジェクトのビルド時に、ランタイムのブートストラッパがプロジェクト内にコピーされます。

    > !type=note
    > 補足：
    > 
    > 「アプリケーションと同じ場所から必須コンポーネントをダウンロードする」を指定してビルドを行うと、セットアップ プログラムにブートストラッパが組み込まれます。アプリケーション配信前にランタイムの事前インストールを行いたい場合には、この方法を利用してランタイム ファイルのみを配布するインストーラを作成することができます。
5. これでMultiRowのランタイム ブートストラッパの組み込みは完了です。あとは通常の手順に従ってインストーラを作成します。

## ClickOnceへのブートストラッパの組み込み

1. アプリケーションのプロジェクトをVisual Studioで開き、〈プロジェクト〉メニューから〈プロパティ〉を表示します。
2. 「発行」タブにある〈必須コンポーネント〉ボタンをクリックし、セットアップ プロジェクトの場合と同様に、必須コンポーネントのリストにある「MultiRow for Windows Forms Runtime 12.0.yyyy.mmdd」にチェックを入れます。
3. セットアップ プロジェクトの場合と同様に、必須コンポーネントのインストール場所を選択します。
4. これで MultiRowのランタイム ブートストラッパの組み込みは完了です。あとは［発行ウィザード］あるいは［今すぐ発行］ボタンをクリックして、通常の手順に従ってアプリケーションを発行します。

## ブートストラッパの特長ならびに注意点

ブートストラッパによるランタイムの配布には、次に示す特長があります。

* アプリケーションの動作に必要なファイルを簡単に配布できます。
* 配布ファイルの過不足やバージョンを管理する負担を軽減できます。
* ランタイム ファイルが圧縮して格納されているため、配布サイズを削減できます。
* ランタイム ファイルをグローバル アセンブリ キャッシュ（GAC）へインストールします。
* GACに既に同じバージョンのアセンブリがインストールされている場合、インストールを自動的にスキップします。
    【制限事項】
    .NET Framework がインストールされていない環境では、GACに既に同じバージョンのアセンブリがインストールされていても、ランタイムのインストールはスキップされません。ただし、ランタイムのインストールを続行しても製品の動作に問題はありません。
* ランタイムファイルを、ユーザーがコントロールパネルからアンインストールすることができます。
> !type=note
> 補足：
>
> * グローバル アセンブリ キャッシュにインストールされるアセンブリはすべてのアプリケーションで共有されるため、特に必要性がない場合はアンインストールする必要はありません。MultiRow のアップデートにより新しいバージョンのアセンブリをインストールする必要がある場合、新しいバージョンをインストールするためのブートストラッパを追加できます。
> * GACへインストールするため、インストーラの実行には管理者権限が必要になります。

> !type=warning
>
> * ブートストラッパには次のインストール条件が組み込まれていますが、この条件はブートストラッパのmsiファイルを直接実行する場合には適用されないため、直接実行はお勧めしません。
> * 管理者権限の有無を事前にチェックし、ユーザーが管理者でない場合にメッセージを表示する。
> * 同じバージョンのアセンブリがグローバル アセンブリ キャッシュに既にインストールされている場合はインストールをスキップする。
> * 組み込むブートストラッパのバージョンと使用しているランタイム ファイル（本体コンポーネント GrapeCity.Win.MultiRow.v120.dll）のバージョンは同じである必要があります。

## 関連トピック

[アプリケーションの配布](gcdocsite__documentlink?toc-item-id=93649f7d-5bab-4da0-a08a-46f6f413378e)
[ランタイム ファイルの配布について](gcdocsite__documentlink?toc-item-id=51d45437-b511-473e-8929-84fc8cdb3bf9)
[XCOPYによる配布](gcdocsite__documentlink?toc-item-id=57af4ff9-7693-4755-8a3e-d87e8c5a4325)
[ClickOnceによる配布](gcdocsite__documentlink?toc-item-id=842e2d9f-f2f6-4ee3-902e-bae042e18e72)