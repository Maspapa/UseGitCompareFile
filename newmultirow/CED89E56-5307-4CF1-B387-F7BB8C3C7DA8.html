<p>セルは、GDIとGDI+の両方による文字列描画をサポートしています。既定の設定では、GDIが使用されます。<a href="gcdocsite__documentlink?toc-item-id=1c5ce59b-63d8-4edc-93ce-5178f9732917" title="">CellStyle.UseCompatibleTextRendering</a>プロパティをTrueに設定すると、GDI+が使用されます。このプロパティの動作は、.NET Framework 2.0以降のLabelコントロールやButtonコントロールと同じです。</p><p>ここでは、<a href="gcdocsite__documentlink?toc-item-id=1c5ce59b-63d8-4edc-93ce-5178f9732917" title="">CellStyle.UseCompatibleTextRendering</a>プロパティの値がTrueの状態を「GDI+互換モード」として解説します。</p><p>セル型がスタイルのGDI+互換モードをサポートしているかどうかは、各<a href="gcdocsite__documentlink?toc-item-id=53f8b81b-ef95-42e6-b7e8-1e7438c9cf39" title="">セル型</a>の「スタイル」を参照してください。</p><blockquote type="warning"><p>!type=warning</p><ul><li><p>GDIとGDI+の差異により、GDI+互換モードを有効にするといくつかの制限事項が生じます。詳細はこのページの「制限事項」を参照してください。</p></li></ul></blockquote><h2>GDI+互換モードの設定</h2><p>GDI+互換モードを有効にするには、CellStyle.UseCompatibleTextRenderingプロパティをTrueに設定します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.MultiRow;

gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.UseCompatibleTextRendering = MultiRowTriState.True;
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Value = <span class="hljs-string">"GDI+互換モード"</span>;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.MultiRow

GcMultiRow1.Rows(0).Cells(0).Style.UseCompatibleTextRendering = MultiRowTriState.True
GcMultiRow1.Rows(0).Cells(0).Value = "GDI+互換モード"</code></pre></div><h2>テキストの均等割付</h2><p>GDI+互換モードが有効のとき、テキストの均等割付を使用できます。</p><p>均等割付の左右のスペースを指定するには、パディングか均等配分の一方または両方を併用できます。Excelと異なり、インデントは均等割付には適用されません。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.MultiRow;

gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.UseCompatibleTextRendering = MultiRowTriState.True;
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.TextAdjustment = TextAdjustment.Distribute;
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Value = <span class="hljs-string">"北海道"</span>;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.MultiRow

GcMultiRow1.Rows(0).Cells(0).Style.UseCompatibleTextRendering = MultiRowTriState.True
GcMultiRow1.Rows(0).Cells(0).Style.TextAdjustment = TextAdjustment.Distribute
GcMultiRow1.Rows(0).Cells(0).Value = "北海道"</code></pre></div><h2>テキストの回転</h2><p>GDI+互換モードが有効のとき、テキストの回転を使用できます。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.MultiRow;

gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.UseCompatibleTextRendering = MultiRowTriState.True;
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.TextAngle = <span class="hljs-number">45f</span>;
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Value = <span class="hljs-string">"京都"</span>;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.MultiRow

GcMultiRow1.Rows(0).Cells(0).Style.UseCompatibleTextRendering = MultiRowTriState.True
GcMultiRow1.Rows(0).Cells(0).Style.TextAngle = 45.0F
GcMultiRow1.Rows(0).Cells(0).Value = "京都"</code></pre></div><h2>テキストの縦書き</h2><p>GDI+互換モードが有効のとき、テキストの縦書きを使用できます。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.MultiRow;

gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.UseCompatibleTextRendering = MultiRowTriState.True;
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.TextVertical = MultiRowTriState.True;
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].VerticalResize(<span class="hljs-number">50</span>);
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Value = <span class="hljs-string">"JR山手線"</span>;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.MultiRow

GcMultiRow1.Rows(0).Cells(0).Style.UseCompatibleTextRendering = MultiRowTriState.True
GcMultiRow1.Rows(0).Cells(0).Style.TextVertical = MultiRowTriState.True
GcMultiRow1.Rows(0).Cells(0).VerticalResize(50)
GcMultiRow1.Rows(0).Cells(0).Value = "JR山手線"</code></pre></div><p>縦書きでは、シフト JISの半角英数や半角カタカナに相当する文字は回転して横書きされます。これらの文字を縦書きする場合は、対応する全角文字を使用してください。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.MultiRow;

gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.UseCompatibleTextRendering = MultiRowTriState.True;
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Style.TextVertical = MultiRowTriState.True;
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].VerticalResize(<span class="hljs-number">50</span>);
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-number">0</span>].Value = <span class="hljs-string">"ＪＲ山手線"</span>;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.MultiRow

GcMultiRow1.Rows(0).Cells(0).Style.UseCompatibleTextRendering = MultiRowTriState.True
GcMultiRow1.Rows(0).Cells(0).Style.TextVertical = MultiRowTriState.True
GcMultiRow1.Rows(0).Cells(0).VerticalResize(50)
GcMultiRow1.Rows(0).Cells(0).Value = "ＪＲ山手線"</code></pre></div><h2>GDI+設定時のリマインダ機能</h2><p>GDI+を設定するために対象のプロパティを変更した場合、「GDI+プロパティ確認」ダイアログを表示してGDI+が有効になる設定を自動で行うことができます。</p><p><br></p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/cellstyle_gdiplus.png" contenteditable="false"><br></p><p><br></p><p>「GDI+プロパティ確認」ダイアログを表示する条件は次のとおりです。</p><table><thead><tr><th><p>プロパティ</p></th><th><p>ダイアログ表示</p></th><th><p>ダイアログ非表示</p></th></tr></thead><tbody><tr><td><p>TextVertical</p></td><td><p>True</p></td><td><p>InheritまたはFalse</p></td></tr><tr><td><p>TextAdjustment</p></td><td><p>InheritまたはNear以外</p></td><td><p>InheritまたはNear</p></td></tr><tr><td><p>LineAdjustment</p></td><td><p>DistributeまたはDistributeWithSpace</p></td><td><p>InheritまたはNone</p></td></tr><tr><td><p>TextAngle</p></td><td><p>NaN以外</p></td><td><p>Nanまたは0</p></td></tr></tbody></table><h2>制限事項</h2><ul><li><p>GDI+互換モードが有効のとき、編集中のセルとそうでないセルとの間で文字の間隔や位置が異なる場合があります。これはGDIとGDI+との差異によるものです。</p><p>（<img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/web.png" alt="Web サイト" contenteditable="false"> Microsoft 社サポート オンライン 文書番号：307208 Why text appears different when drawn with GDIPlus versus GDI <a href="http://support.microsoft.com/kb/307208/" title="">http://support.microsoft.com/kb/307208/</a>）</p></li><li><p>GDI+互換モードが有効のとき、セルのフォントにMicrosoft Sans Serifを指定すると、非編集時に半角円記号がバックスラッシュとして表示されます。</p></li><li><p>GDI+互換モードが有効のとき、ワードラップを有効にすると空白文字が表示されない場合があります。</p></li><li><p>GDI+互換モードが有効のとき、全角ハイフンが表示されない場合があります。これはGDI+の仕様によるものです。</p><p>この問題は、2008年11月に同社より修正プログラムが公開されました。</p><p>（<img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/web.png" alt="Web サイト" contenteditable="false"> Microsoft 社サポート オンライン 文書番号：956807 Windows Server 2008、Windows Vista、Windows Server 2003、および Windows XP で GDI+ API 関数を使用するアプリケーションを使用すると、Unicode ハイフン文字 (U+2010) が描画されない <a href="http://support.microsoft.com/kb/956807/ja" title="">http://support.microsoft.com/kb/956807/ja</a>）</p></li><li><p>GDI+互換モードが有効のとき、タブ文字（タブストップ）は表示されません。これはMultiRowの実装による制限です。</p></li><li><p>GDI+互換モードが有効のとき、Unicodeの結合文字および制御文字は正しく表示されません。</p><p>（例："\u0041\u0301\u304b\u3099\u304b\u309a", "\u202e正大光明\u202c"）</p></li><li><p>GDI+互換モードが有効のとき、同じ文字が連続している場合に文字幅が不正になる場合があります。</p><p>（例："jjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjj"）</p></li><li><p>GDI+互換モードが有効のとき、環境依存文字を正しく描画できません。詳細は、「<a href="gcdocsite__documentlink?toc-item-id=1ddfaac1-0b7a-40c3-80fe-7203b9402694" title="">環境依存文字を表示できない</a>」を参照してください。</p></li></ul><h2>関連トピック</h2><p><a href="gcdocsite__documentlink?toc-item-id=0659dda6-b828-4148-a42a-71244a85690c" title="">セルのスタイル</a></p><p><a href="gcdocsite__documentlink?toc-item-id=7bd4c3f5-3a4b-47d1-a04d-c6b0eb34b77e" title="">スタイルの適用ルール</a></p><p><a href="gcdocsite__documentlink?toc-item-id=1f3aedd3-7f2e-404f-9b1c-a035fb3a0028" title="">罫線</a></p><p><a href="gcdocsite__documentlink?toc-item-id=659c8f82-913c-4151-ac57-5489df055fff" title="">背景色と前景色</a></p><p><a href="gcdocsite__documentlink?toc-item-id=890081a2-3af9-4359-8697-d49b65dfe284" title="">背景パターン</a></p><p><a href="gcdocsite__documentlink?toc-item-id=2e54d2f0-6317-4fce-a74e-8b763f3f2f10" title="">背景グラデーション</a></p><p><a href="gcdocsite__documentlink?toc-item-id=fb73f7b0-aae0-43fa-aacd-4a74f84fa16a" title="">タグ</a></p><p><a href="gcdocsite__documentlink?toc-item-id=7ccdf46e-326e-4f4f-a097-051ad2700b6e" title="">イメージ</a></p><p><a href="gcdocsite__documentlink?toc-item-id=a9f06eec-b225-4b07-826e-f14a1e77d6ca" title="">マージンとパディング</a></p><p><a href="gcdocsite__documentlink?toc-item-id=7fcbd91a-83ac-4f84-b8dc-a9061553177d" title="">IMEモード</a></p><p><a href="gcdocsite__documentlink?toc-item-id=b113b6cb-598e-48a9-917e-8eec48db994b" title="">複数行とワードラップ</a></p><p><a href="gcdocsite__documentlink?toc-item-id=e32f062a-3075-439c-a2f2-3c7a07840510" title="">文字書式</a></p><p><a href="gcdocsite__documentlink?toc-item-id=122eb1b4-e5f2-48d3-ab7c-a0249190a034" title="">テキストのインデント</a></p><p><a href="gcdocsite__documentlink?toc-item-id=048b62a5-4dee-44f2-85de-b20c61c8c644" title="">マウスホバーのスタイル</a></p><p><a href="gcdocsite__documentlink?toc-item-id=1e2c91d2-750e-44f1-bc8f-05d6c9729caf" title="">ユーザー定義のワードラップ</a></p><p><a href="gcdocsite__documentlink?toc-item-id=5a7efb6e-2090-42a0-b4ca-026b541f2de9" title="">半角文字の均等割付のカスタマイズ</a></p>