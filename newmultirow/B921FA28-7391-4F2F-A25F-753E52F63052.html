<p>セルは、各セクションに配置できる四角形のオブジェクトです。MultiRowのセルは、ExcelやDataGridViewのセルと同じようにユーザーによる選択や入力に使用できます。他のグリッドコントロールとの大きな違いは、開発者がこのセルを任意の場所に任意の大きさで配置できるということです。</p><p>設計時にデザイナで行に配置されたセルは</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/architecture_cell_designtimecell.png" contenteditable="false"><br></p><p>実行時にはデータ数に応じてCloneメソッドで複製され、繰り返し表示されます。ヘッダとフッタに配置したセルはそのまま表示されます。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/architecture_cell_runtimecell.png" contenteditable="false"><br></p><h2>セルの選択</h2><p>各セルは選択が可能かどうかの指定と、セルが選択されているかどうかの状態の判定、選択された場合とそうでない場合との外観の指定が可能です。選択をまったく許可しなかったり、選択をスキップして編集に遷移することもできます。（参考：<a href="gcdocsite__documentlink?toc-item-id=05E1230B-6129-43D3-AA78-5B2CBF48CCBA" title="">選択モード</a>、<a href="gcdocsite__documentlink?toc-item-id=34EAB7A7-4714-49AE-B8DF-7AFA70750DA1" title="">選択された行とセル</a>、<a href="gcdocsite__documentlink?toc-item-id=44b1d9b5-a649-4d0d-b686-4884fcfd887a" title="">セルの選択禁止</a>）</p><h2>セルのインデックス</h2><p>セルにはセクションに追加した順にインデックス（Cell.Index）が割り当てられます。実行時には、このインデックスを使用して行や列ヘッダセクションに配置されている任意のセルを指定できます。セルのインデックスは、Cell.Indexプロパティまたはデザイナの操作で変更できます。</p><p>セルのインデックスは特定の範囲のセルを連続して処理する場合や、不特定多数のセルを処理する場合に適しています。個別のセルを指定する場合は後述のセル名を使用してください。</p><h2>セル名</h2><p>セル名（Cell.Name）を指定すると、セルのコレクションからこの名をキーにして対象のセルにアクセスできます。これは、Windowsフォームでコントロールに名前をつけたとき、Form.Controlsプロパティから次のようなコードで対象のコントロールにアクセスできることに似ています。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp">TextBox textBox1 = <span class="hljs-keyword">new</span> TextBox();
textBox1.Name = <span class="hljs-string">"textBox1"</span>;
<span class="hljs-keyword">this</span>.Controls.Add(textBox1);
<span class="hljs-keyword">this</span>.Controls[<span class="hljs-string">"textBox1"</span>].Text = <span class="hljs-string">"Hello"</span>;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Dim TextBox1 As New TextBox()
TextBox1.Name = "TextBox1"
Me.Controls.Add(TextBox1)
Me.Controls("TextBox1").Text = "Hello"</code></pre></div><p>MultiRowでは次のように名前をつけたセルにアクセスできます。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.MultiRow;

<span class="hljs-comment">// テンプレートを作成する</span>
TextBoxCell textBoxCell1 = <span class="hljs-keyword">new</span> TextBoxCell();
textBoxCell1.Name = <span class="hljs-string">"textBoxCell1"</span>;

gcMultiRow1.Template = Template.CreateGridTemplate(<span class="hljs-keyword">new</span> Cell[] {textBoxCell1});
gcMultiRow1.RowCount = <span class="hljs-number">3</span>;

<span class="hljs-comment">// 実行時の操作</span>
gcMultiRow1.Rows[<span class="hljs-number">0</span>].Cells[<span class="hljs-string">"textBoxCell1"</span>].Value = <span class="hljs-string">"Hello"</span>;
gcMultiRow1.SetValue(<span class="hljs-number">1</span>, <span class="hljs-string">"textBoxCell1"</span>, <span class="hljs-string">"Hello"</span>);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.MultiRow

' テンプレートを作成する
Dim TextBoxCell1 As New TextBoxCell()
TextBoxCell1.Name = "TextBoxCell1"

GcMultiRow1.Template = Template.CreateGridTemplate(New Cell() {TextBoxCell1})
GcMultiRow1.RowCount = 3

' 実行時の操作
GcMultiRow1.Rows(0).Cells("TextBoxCell1").Value = "Hello"
GcMultiRow1.SetValue(1, "TextBoxCell1", "Hello")</code></pre></div><h2>位置とサイズ</h2><p>セルの位置は、セルの親となるセクションの左上隅からの相対座標で指定できます。これは、フォームにコントロールを配置する場合と同じです。セルのサイズは、高さと幅を指定できます。セルは矩形のため、これらの要素だけでセルの配置が確定します。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/architecture_cell_size.png" contenteditable="false"><br></p><h2>セルのリサイズ</h2><p>既定の状態では、セルの配置に応じてセルのリサイズが自動的に決定されます。たとえば、ヘッダの幅に合わせて行のセルを配置するだけで、実行時にはヘッダのサイズ変更に合わせてセルの幅や高さが追従します。デザイナでは、スナップラインの補助によって位置調整をそれほど意識せずに指定できます。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/architecture_cell_resizing.png" contenteditable="false"><br></p><h2>マージンとパディング</h2><p>フォーム上のコントロールと同じように、セルにはスタイルの一部としてマージンとパディングを指定できます。マージンは、セルの外側の余白を定義します。マージンはセルの内容に影響を与えないため、設計時にスナップラインを使う場合のみ有効な機能です。パディングはセルの内側の余白を定義します。</p><p>次の図は、buttonCell1にマージンとパディングを四辺それぞれ10ピクセルで定義した例です。青い線はマージン、赤い線はパディングを示します。buttonCell2とbuttonCell3は比較のためマージンとパディングを変更していません。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/architecture_cell_marginpadding.png" contenteditable="false"><br></p><h2>継承</h2><p>セルを継承して独自のセル型を作成できます。基本セルを使用してゼロから新しいセルを作ることも、既存の組み込みのセルを継承して拡張機能を作ることもできます。作成したセル型はクラスとしてプロジェクト間での共有や再利用が可能です。</p><p>たとえば、フィルタリング用にカスタマイズされたFilteringTextBoxCellはTextBoxCellから派生し、左上のヘッダの用途に特化したColumnHeaderCellは汎用のHeaderCellから派生しています。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/architecture_cell_inheritedclass.png" contenteditable="false"><br></p><h2>セルの共通の設定</h2><p>すべてのセル型は共通のCellクラスから派生しています。これは、すべてのコントロールがSystem.Windows.Forms.Controlクラスから派生しているのに似ています。コントロールの場合と同じように、CellクラスはLocationやSizeといったセルの基本的な機能を提供しています。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/architecture_cell_baseclass.png" contenteditable="false"><br></p><h2>セルのスタイル</h2><p>セルのスタイルは、個々のセルから独立しています。たとえば、背景色や画像の設定は、特定のセルだけでなく、多くのセルで共通して使用されます。このような設定が、セルのスタイルとして共通のオブジェクトで提供されています。この仕組みは、DataGridViewコントロールで、セルのスタイルがDataGridViewCellStyleとして提供されているのと同じです。どのセルがスタイルのどの設定に対応しているかどうかはセルごとに異なりますが、多くのセルでは主要なスタイルの設定をサポートしています。</p><h2>ヘッダセル</h2><p>ヘッダセルはグリッドの操作を実行するための特別なセルです。たとえばセルを選択したり、ソートしたりできます。ヘッダセルは３種類が提供され、それぞれヘッダの３箇所に対応しています。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/architecture_cell_headers.png" contenteditable="false"><br></p><p>すべてのヘッダセルは、共通の設定を持つヘッダ型セルから派生しています。</p><ul><li><p>ヘッダ型セル</p></li><li><p>列ヘッダ型セル</p></li><li><p>行ヘッダ型セル</p></li><li><p>コーナーヘッダ型セル</p></li></ul><h2>編集</h2><p>MultiRowはセル型の編集コントロールとして、.NET Frameworkの標準コントロールをそのまま実装しています。たとえば、文字列型セル（TextBoxCell）の編集には、System.Windows.Forms.TextBoxコントロールが表示されます。このため、セルの編集時の動作は、標準コントロールとまったく同じイベントを使用してカスタマイズできます。</p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/f148c511-6e98-4b55-9904-150a375d5825/images/userguide/architecture_cell_editingcontrol.png" contenteditable="false"><br></p><p>MultiRowのセル編集コントロールの機能は、共通のインタフェースIEditingControlによって定義されます。このインタフェースでは、編集中のマウスカーソル、編集する値、親となるGcMultiRowコントロールへの参照、現在の行番号、ズームの値、編集コントロールの準備を定義します。</p><p><br></p><p>次の表は、セル型とセル編集コントロールの対応です。セル編集コントロールが存在しないセル型では、グリッドのイベントを使用します。</p><table><thead><tr><th><p>セル型</p></th><th><p>セル編集コントロール</p></th><th><p>継承元</p></th></tr></thead><tbody><tr><td><p>ComboBoxCell</p></td><td><p>ComboBoxEditingControl</p></td><td><p>System.Windows.Forms.ComboBox</p></td></tr><tr><td><p>DateTimePickerCell</p></td><td><p>DateTimePickerEditingControl</p></td><td><p>System.Windows.Forms.DateTimePicker</p></td></tr><tr><td><p>DomainUpDownCell</p></td><td><p>DomainUpDownEditingControl</p></td><td><p>System.Windows.Forms.DomainUpDown</p></td></tr><tr><td><p>NumericUpDownCell</p></td><td><p>NumericUpDownEditingControl</p></td><td><p>System.Windows.Forms.NumericUpDown</p></td></tr><tr><td><p>MaskedTextBoxCell</p></td><td><p>MaskedTextBoxEditingControl</p></td><td><p>System.Windows.Forms.MaskedTextBox</p></td></tr><tr><td><p>RichTextBoxCell</p></td><td><p>RichTextBoxEditingControl</p></td><td><p>System.Windows.Forms.RichTextBox</p></td></tr><tr><td><p>TextBoxCell</p></td><td><p>TextBoxEditingControl</p></td><td><p>System.Windows.Forms.TextBox</p></td></tr></tbody></table><h2>描画モード</h2><p>MultiRowのセルは、.NET Frameworkの標準コントロールと同じようにGDIとGDI+の２種類の描画モードをサポートします。GDIは既定の描画モードとして、セルの編集に使用されるコントロールと同じ描画を提供します。GDI+は縦書き表示や均等割付に使用します。</p><p>詳細は「<a href="gcdocsite__documentlink?toc-item-id=9b34fee2-3101-44f6-8e71-6cd80cca6a4d" title="">GDI+互換モード</a>」を参照してください。</p><h2>関連トピック</h2><p><a href="gcdocsite__documentlink?toc-item-id=56965dab-d6cc-47fc-99fe-d91b89d5a68b" title="">MultiRowのアーキテクチャ</a></p><p><a href="gcdocsite__documentlink?toc-item-id=16f883de-1a34-4c65-a48a-54975c8e3f1d" title="">基本的な概念</a></p><p><a href="gcdocsite__documentlink?toc-item-id=34b86ed6-9e19-4958-86bf-0292df8c1533" title="">テンプレートの構造</a></p><p><a href="gcdocsite__documentlink?toc-item-id=ce4d580a-53b6-41d6-90e6-24d7ca29d7cc" title="">テンプレート ファイル</a></p><p><a href="gcdocsite__documentlink?toc-item-id=6e2489d4-8b06-4f4c-9469-4603ae386ed1" title="">書式文字列</a></p><p><a href="gcdocsite__documentlink?toc-item-id=05924354-cd16-4f19-b351-374d4fa67db1" title="">日本語環境固有の対応</a></p><p><a href="gcdocsite__documentlink?toc-item-id=9b34fee2-3101-44f6-8e71-6cd80cca6a4d" title="">GDI+互換モード</a></p>