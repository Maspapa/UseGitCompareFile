ランタイムファイルの配布方法には、製品に付属するWindows インストーラブートストラッパを使用する方法とランタイムファイルを直接コピーする方法の2種類があります。

## ブートストラッパを使用してランタイムファイルを配布する

ブートストラッパ（bootstrapper）とは、アプリケーションのインストールの前にそのアプリケーションの実行に必要なランタイムファイルをインストールするインストーラの総称です。PlusPak がインストールされた開発環境には、PlusPak 専用のランタイムブートストラッパが用意されており、セットアッププロジェクトまたはClickOnce へ簡単に組み込むことが可能です。

#### インストーラへブートストラッパを組み込む

1. セットアッププロジェクトをVisual Studio で開き、〈プロジェクト〉メニューから〈プロパティ〉を表示します。
2. 〈必須コンポーネント〉ボタンをクリックし、必須コンポーネントのリストにある「PlusPak for Windows Forms Runtime 13.0.48xx.2017」にチェックを入れます。
<br>
    ![](/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/06fadbb1-c461-433a-b385-ae4966e56069/images/deployment.runtime.png)
<br>
3. 必須コンポーネントのインストール場所を指定します。「必須コンポーネントをコンポーネントの開発元のWebサイトからダウンロードする」にすると、セットアップ起動時に開発元のWebサイトからランタイムのブートストラッパをダウンロードします。「アプリケーションと同じ場所から必須コンポーネントをダウンロードする」にすると、プロジェクトのビルド時に、ランタイムのブートストラッパがプロジェクト内にコピーされます。
    **補足**
「アプリケーションと同じ場所から必須コンポーネントをダウンロードする」を指定してビルドを行うと、セットアッププログラムにブートストラッパが組み込まれます。アプリケーション配信前にランタイムの事前インストールを行いたい場合には、この方法を利用してランタイムファイルのみを配布するインストーラを作成することができます。
4. これでPlusPak のランタイムブートストラッパの組み込みは完了です。あとは通常の手順に従ってインストーラを作成します。

#### ClickOnce へブートストラッパを組み込む

1. アプリケーションのプロジェクトをVisual Studio で開き、〈プロジェクト〉メニューから〈プロパティ〉を表示します。
2. 「発行」タブにある〈必須コンポーネント〉ボタンをクリックし、セットアッププロジェクトの場合と同様に、必須コンポーネントのリストにある「PlusPak for Windows Forms Runtime 12.0.40xx.2012」にチェックを入れます。
3. セットアッププロジェクトの場合と同様に、必須コンポーネントのインストール場所を選択します。
4. これでPlusPak のランタイムブートストラッパの組み込みは完了です。あとは［発行ウィザード］あるいは［今すぐ発行］ボタンをクリックして、通常の手順に従ってアプリケーションを発行します。

#### ブートストラッパの特長ならびに注意点

ブートストラッパによるランタイムの配布には、次に示す特長があります。

#### 特長

* アプリケーションの動作に必要なファイルを簡単に配布できます。
* 配布ファイルの過不足やバージョンを管理する負担を軽減できます。
* ランタイムファイルが圧縮して格納されているため、配布サイズを削減できます。
* ランタイムファイルをグローバルアセンブリキャッシュ（GAC）へインストールします。
* GAC に既に同じバージョンのアセンブリがインストールされている場合、インストールを自動的にスキップします。
    【制限事項】
    .NET Framework 2.0 がインストールされていない環境では、GAC に既に同じバージョンのアセンブリがインストールされていても、ランタイムのインストールはスキップされません。ただし、ランタイムのインストールを続行しても製品の動作に問題はありません。
* ランタイムファイルを、ユーザーがコントロールパネルからアンインストールすることができます。
<br>
    **補足**
    * グローバルアセンブリキャッシュにインストールされるアセンブリはすべてのアプリケーションで共有されるため、特に必要性がない場合はアンインストールする必要はありません。PlusPak のアップデートにより新しいバージョンのアセンブリをインストールする必要がある場合、新しいバージョンをインストールするためのブートストラッパを追加できます。
    * GAC へインストールするため、インストーラの実行には管理者権限が必要になります。
<br>

> !type=warning
>
> * ブートストラッパには次のインストール条件が組み込まれていますが、この条件はブートストラッパのmsi ファイルを直接実行する場合には適用されないため、直接実行はお勧めしません。
>     * 管理者権限の有無を事前にチェックし、ユーザーが管理者でない場合にメッセージを表示する。
>     * 同じバージョンのアセンブリがグローバルアセンブリキャッシュに既にインストールされている場合はインストールをスキップする。
> * 組み込むブートストラッパのバージョンと使用しているランタイムファイル（本体コンポーネントGrapeCity.Win.PlusPak.v100.dll）のバージョンは同じである必要があります。

## ランタイムファイルを直接コピーする

ブートストラッパを使用せずにランタイムファイルを直接コピーする場合は、以下のフォルダからコピーします。PlusPakの再配布可能なファイルは、[ランタイムファイルの配布について](gcdocsite__documentlink?toc-item-id=89d76575-e4e9-494b-bbd1-286a0939d964)を参照してください。

```auto
＜製品インストールフォルダ＞\Bin
```

GAC にランタイムファイルがインストールされている場合や後からGAC へランタイムファイルがインストールされた場合、ローカルにランタイムファイルをコピーしてもアプリケーションはGAC にインストールされたアセンブリを優先して参照します。

## 関連トピック

[アプリケーションの配布](gcdocsite__documentlink?toc-item-id=78961906-b824-4941-adce-fba201915a69)
[ランタイムファイルの配布について](gcdocsite__documentlink?toc-item-id=89d76575-e4e9-494b-bbd1-286a0939d964)