<p>ランタイムファイルの配布方法には、製品に付属するWindows インストーラブートストラッパを使用する方法とランタイムファイルを直接コピーする方法の2種類があります。</p><h2>ブートストラッパを使用してランタイムファイルを配布する</h2><p>ブートストラッパ（bootstrapper）とは、アプリケーションのインストールの前にそのアプリケーションの実行に必要なランタイムファイルをインストールするインストーラの総称です。PlusPak がインストールされた開発環境には、PlusPak 専用のランタイムブートストラッパが用意されており、セットアッププロジェクトまたはClickOnce へ簡単に組み込むことが可能です。</p><h4>インストーラへブートストラッパを組み込む</h4><ol><li><p>セットアッププロジェクトをVisual Studio で開き、〈プロジェクト〉メニューから〈プロパティ〉を表示します。</p></li><li><p>〈必須コンポーネント〉ボタンをクリックし、必須コンポーネントのリストにある「PlusPak for Windows Forms Runtime 13.0.48xx.2017」にチェックを入れます。</p><p><br></p><p><img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/06fadbb1-c461-433a-b385-ae4966e56069/images/deployment.runtime.png" contenteditable="false"><br></p><p><br></p></li><li><p>必須コンポーネントのインストール場所を指定します。「必須コンポーネントをコンポーネントの開発元のWebサイトからダウンロードする」にすると、セットアップ起動時に開発元のWebサイトからランタイムのブートストラッパをダウンロードします。「アプリケーションと同じ場所から必須コンポーネントをダウンロードする」にすると、プロジェクトのビルド時に、ランタイムのブートストラッパがプロジェクト内にコピーされます。</p><p><strong>補足</strong></p><p>「アプリケーションと同じ場所から必須コンポーネントをダウンロードする」を指定してビルドを行うと、セットアッププログラムにブートストラッパが組み込まれます。アプリケーション配信前にランタイムの事前インストールを行いたい場合には、この方法を利用してランタイムファイルのみを配布するインストーラを作成することができます。</p></li><li><p>これでPlusPak のランタイムブートストラッパの組み込みは完了です。あとは通常の手順に従ってインストーラを作成します。</p></li></ol><h4>ClickOnce へブートストラッパを組み込む</h4><ol><li><p>アプリケーションのプロジェクトをVisual Studio で開き、〈プロジェクト〉メニューから〈プロパティ〉を表示します。</p></li><li><p>「発行」タブにある〈必須コンポーネント〉ボタンをクリックし、セットアッププロジェクトの場合と同様に、必須コンポーネントのリストにある「PlusPak for Windows Forms Runtime 12.0.40xx.2012」にチェックを入れます。</p></li><li><p>セットアッププロジェクトの場合と同様に、必須コンポーネントのインストール場所を選択します。</p></li><li><p>これでPlusPak のランタイムブートストラッパの組み込みは完了です。あとは［発行ウィザード］あるいは［今すぐ発行］ボタンをクリックして、通常の手順に従ってアプリケーションを発行します。</p></li></ol><h4>ブートストラッパの特長ならびに注意点</h4><p>ブートストラッパによるランタイムの配布には、次に示す特長があります。</p><h4>特長</h4><ul><li><p>アプリケーションの動作に必要なファイルを簡単に配布できます。</p></li><li><p>配布ファイルの過不足やバージョンを管理する負担を軽減できます。</p></li><li><p>ランタイムファイルが圧縮して格納されているため、配布サイズを削減できます。</p></li><li><p>ランタイムファイルをグローバルアセンブリキャッシュ（GAC）へインストールします。</p></li><li><p>GAC に既に同じバージョンのアセンブリがインストールされている場合、インストールを自動的にスキップします。</p><p>【制限事項】</p><p>.NET Framework 2.0 がインストールされていない環境では、GAC に既に同じバージョンのアセンブリがインストールされていても、ランタイムのインストールはスキップされません。ただし、ランタイムのインストールを続行しても製品の動作に問題はありません。</p></li><li><p>ランタイムファイルを、ユーザーがコントロールパネルからアンインストールすることができます。</p><p><br></p><p><strong>補足</strong></p><ul><li><p>グローバルアセンブリキャッシュにインストールされるアセンブリはすべてのアプリケーションで共有されるため、特に必要性がない場合はアンインストールする必要はありません。PlusPak のアップデートにより新しいバージョンのアセンブリをインストールする必要がある場合、新しいバージョンをインストールするためのブートストラッパを追加できます。</p></li><li><p>GAC へインストールするため、インストーラの実行には管理者権限が必要になります。</p><p><br></p></li></ul></li></ul><blockquote type="warning"><p>!type=warning</p><ul><li><p>ブートストラッパには次のインストール条件が組み込まれていますが、この条件はブートストラッパのmsi ファイルを直接実行する場合には適用されないため、直接実行はお勧めしません。</p><ul><li><p>管理者権限の有無を事前にチェックし、ユーザーが管理者でない場合にメッセージを表示する。</p></li><li><p>同じバージョンのアセンブリがグローバルアセンブリキャッシュに既にインストールされている場合はインストールをスキップする。</p></li></ul></li><li><p>組み込むブートストラッパのバージョンと使用しているランタイムファイル（本体コンポーネントGrapeCity.Win.PlusPak.v100.dll）のバージョンは同じである必要があります。</p></li></ul></blockquote><h2>ランタイムファイルを直接コピーする</h2><p>ブートストラッパを使用せずにランタイムファイルを直接コピーする場合は、以下のフォルダからコピーします。PlusPakの再配布可能なファイルは、<a href="gcdocsite__documentlink?toc-item-id=89d76575-e4e9-494b-bbd1-286a0939d964" title="">ランタイムファイルの配布について</a>を参照してください。</p><div data-language="auto" class="toastui-editor-ww-code-block-highlighting"><pre><code>＜製品インストールフォルダ＞\Bin</code></pre></div><p>GAC にランタイムファイルがインストールされている場合や後からGAC へランタイムファイルがインストールされた場合、ローカルにランタイムファイルをコピーしてもアプリケーションはGAC にインストールされたアセンブリを優先して参照します。</p><h2>関連トピック</h2><p><a href="gcdocsite__documentlink?toc-item-id=78961906-b824-4941-adce-fba201915a69" title="">アプリケーションの配布</a></p><p><a href="gcdocsite__documentlink?toc-item-id=89d76575-e4e9-494b-bbd1-286a0939d964" title="">ランタイムファイルの配布について</a></p>