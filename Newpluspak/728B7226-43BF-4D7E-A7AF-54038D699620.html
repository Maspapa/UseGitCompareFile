<p>本項ではGcMouseコンポーネントを利用したマウス操作の制御について解説します。</p><h2>クリック時の動作設定</h2><p>ProcessFirstClickプロパティを利用すると、非アクティブなフォーム上のコントロールをクリックしたとき、クリックしたコントロールにフォーカスを持たせるかどうかを制御できます。</p><h4>既定の動作とProcessFirstClick プロパティ</h4><p>既定の動作では、非アクティブなフォーム上にあるコントロールのクリックにより、フォームがアクティブになると共にクリックされたコントロールがフォーカスを取得します。</p><p><a href="gcdocsite__documentlink?toc-item-id=86a9045b-1135-49c0-bd25-f80c674ca1c4" title="">ProcessFirstClick</a>プロパティをFalseに設定することにより、この動作の抑制が可能です。</p><p>この場合、どのコントロールをクリックした場合でも、フォームが非アクティブになる前にフォーカスを持っていたコントロールが、そのままフォーカスを保持します。</p><p>この機能は、頻繁に画面の切り替えが発生し、なおかつ入力対象のコントロールを保持するようなケースで便利です。</p><h4>サンプルコード</h4><p>次のコードでは、非アクティブなフォーム上にあるコントロールへのクリックに対して、非アクティブとなる前のフォーカス状態を保持するように設定を行います。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp">gcMouse1.ProcessFirstClick = False;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">GcMouse1.ProcessFirstClick = False</code></pre></div><h2>マウスホイール動作の設定</h2><p><a href="gcdocsite__documentlink?toc-item-id=7eda4f22-b0d0-4b85-915f-49a8f7107f28" title="">MouseWheelTarget</a>プロパティの利用により、フォーム上でマウスホイール操作を操作したとき、操作の対象となるコントロールの種類を設定できます。</p><table><thead><tr><th><p>プロパティ値</p></th><th><p>説明</p></th></tr></thead><tbody><tr><td><p>FocusedControl</p></td><td><p>フォーム上のアクティブな（フォーカスのある）コントロールに対してホイール操作が有効になります。</p></td></tr><tr><td><p>HoveredControl</p></td><td><p>フォーカスの有無にかかわらず、マウスポインタの下にあるコントロールに対してホイール操作が有効になります。</p></td></tr><tr><td><p>SpecifiedControl</p></td><td><p>フォーカスの有無にかかわらず、<a href="gcdocsite__documentlink?toc-item-id=974d00f2-c3b5-49c5-9ed9-c102d30e8c0b" title="">MouseWheelTargetControl</a>プロパティで指定されたコントロールに対してホイール操作が有効になります。</p></td></tr></tbody></table><p>次のコードは、<a href="gcdocsite__documentlink?toc-item-id=7eda4f22-b0d0-4b85-915f-49a8f7107f28" title="">MouseWheelTarget</a>プロパティ に<a href="gcdocsite__documentlink?toc-item-id=c2cdf667-7488-4a34-a054-a6268910c5bc" title="">SpecifiedControl</a>を設定し、フォーム上のどの位置でマウスホイールを操作しても、ListBoxコントロールがスクロールされる例です。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp">gcMouse1.MouseWheelTarget = GrapeCity.Win.Components.MouseWheelTarget.SpecifiedControl;
gcMouse1.MouseWheelTargetControl = listBox1;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">GcMouse1.MouseWheelTarget = GrapeCity.Win.Components.MouseWheelTarget.SpecifiedControl
GcMouse1.MouseWheelTargetControl = ListBox1</code></pre></div><p>また、<a href="gcdocsite__documentlink?toc-item-id=7eda4f22-b0d0-4b85-915f-49a8f7107f28" title="">MouseWheelTarget</a>プロパティ に<a href="gcdocsite__documentlink?toc-item-id=c2cdf667-7488-4a34-a054-a6268910c5bc" title="">SpecifiedControl</a>を設定する場合、MouseWheelTargetControlの変化に応じて<a href="gcdocsite__documentlink?toc-item-id=4f51ebe8-61e8-4e20-944b-940873803acb" title="">MouseWheelTargetControlChanged</a>イベントが発生します。</p><h2>動的なコンポーネントの利用</h2><p>デザイン画面からの設定ではなく、コードから動的にGcMouseコンポーネントを生成する場合には、TargetFormプロパティに対象とするフォームを設定する必要があります。</p><p>下記のサンプルコードは、GcMouseコンポーネントを動的に生成し、フォームを指定する例です。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-comment">//GcMouseコンポーネントを動的に生成します。</span>
GrapeCity.Win.Components.GcMouse gcMouse1 = <span class="hljs-keyword">new</span> GrapeCity.Win.Components.GcMouse();
<span class="hljs-comment">//対象のフォームを指定します。</span>
gcMouse1.TargetForm = <span class="hljs-keyword">this</span>;
<span class="hljs-comment">//フォーカスのあるコントロールをホイール操作対象に設定します。</span>
gcMouse1.MouseWheelTarget = GrapeCity.Win.Components.MouseWheelTarget.FocusedControl;</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">'GcMouseコンポーネントを動的に生成します。
Dim GcMouse1 As GrapeCity.Win.Components.GcMouse = New GrapeCity.Win.Components.GcMouse()
'対象のフォームを指定します。
GcMouse1.TargetForm = Me
'フォーカスのあるコントロールをホイール操作対象に設定します。
GcMouse1.MouseWheelTarget = GrapeCity.Win.Components.MouseWheelTarget.FocusedControl</code></pre></div><h2>関連トピック</h2><p><a href="gcdocsite__documentlink?toc-item-id=751817cf-dba1-4d77-b5a3-edde37a466fb" title="">GcMouseコンポーネント</a></p>