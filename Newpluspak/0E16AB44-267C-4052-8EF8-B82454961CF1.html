<p>GcCalculator コントロールのすべてのボタンに任意のキーを割り当てることができます。その仕組みと方法について、以下に解説します。</p><h2>ButtonMappings プロパティ</h2><p>GcCalculator コントロールでは、電卓のすべての操作をキーボードから行えるようにするために、電卓の各ボタンにショートカットキーを割り付ける機能が用意されています。この機能は、<a href="gcdocsite__documentlink?toc-item-id=6d5f36a6-b58f-4cda-ab4f-1f6c229b4112" title="">ButtonMappings</a> プロパティが参照する <a href="gcdocsite__documentlink?toc-item-id=1b0a51e0-b082-402c-b42a-478eb17ad7a9" title="">CalculatorButtonMappingCollection</a> コレクションによって実現されます。</p><p><a href="gcdocsite__documentlink?toc-item-id=1b0a51e0-b082-402c-b42a-478eb17ad7a9" title="">CalculatorButtonMappingCollection</a> コレクションは、電卓のボタンに割り付けるショートカットキーを追加または削除するために、以下のメソッドを持っています。</p><ul><li><p><a href="gcdocsite__documentlink?toc-item-id=71832f5e-9066-4abc-8bb7-180c4d192d32" title="">Add</a></p></li><li><p><a href="gcdocsite__documentlink?toc-item-id=a862d07f-8039-42c9-b8c9-7ab57871477a" title="">AddRange</a></p></li><li><p><a href="gcdocsite__documentlink?toc-item-id=2cc5b926-2ae0-4ec3-ad63-4245a49b93c3" title="">Insert</a></p></li><li><p><a href="gcdocsite__documentlink?toc-item-id=916c135d-601a-496f-9232-2e86c4fdfbc1" title="">Remove</a></p></li></ul><p><a href="gcdocsite__documentlink?toc-item-id=71832f5e-9066-4abc-8bb7-180c4d192d32" title="">Add</a> は、単独のショートカットキーをコレクションに追加するときに使用し、<a href="gcdocsite__documentlink?toc-item-id=a862d07f-8039-42c9-b8c9-7ab57871477a" title="">AddRange</a> は、複数のショートカットキーを同時にコレクションに登録する場合に使用します。また、<a href="gcdocsite__documentlink?toc-item-id=2cc5b926-2ae0-4ec3-ad63-4245a49b93c3" title="">Insert</a> は、コレクション内の位置を指定してショートカットキーを追加できます。これらのメソッドで追加したショートカットキーは、<a href="gcdocsite__documentlink?toc-item-id=916c135d-601a-496f-9232-2e86c4fdfbc1" title="">Remove</a> で削除します。</p><p>なお、<a href="gcdocsite__documentlink?toc-item-id=1b0a51e0-b082-402c-b42a-478eb17ad7a9" title="">CalculatorButtonMappingCollection</a>コレクションに重複したキーを設定することはできません。たとえば、キーボードの［X］キーに逆数を計算する機能を割り付けた後に、同じ［X］キーに別の機能を割り付けることはできません。</p><p>ショートカットキーを割り当てる対象となるボタンはボタンのキー名で指定し、ショートカットキーは<img src="/DOCUMENT_SITE_LINK_PREFIX_HERE/document-site-files/images/06fadbb1-c461-433a-b385-ae4966e56069/images/weblink.png" alt="Web サイト" contenteditable="false"><a href="http://msdn2.microsoft.com/ja-jp/library/system.windows.forms.keys(VS.80).aspx" title="">System.Windows.Forms.Keys</a> 列挙体で指定します。</p><h2>サンプルコード</h2><p>次のサンプルコードは、<a href="gcdocsite__documentlink?toc-item-id=a862d07f-8039-42c9-b8c9-7ab57871477a" title="">AddRange</a> メソッドを使ってボタンの機能をキーに割り付ける方法を示します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-comment">// ２つのキー［P］と［M］にボタンの"+"と"-"を設定します。</span>
Keys[] keysSpecified = {Keys.P, Keys.M};
<span class="hljs-built_in">string</span>[] buttonsSpecified = {<span class="hljs-string">"+"</span>, <span class="hljs-string">"-"</span>};
gcCalculator1.ButtonMappings.AddRange(keysSpecified, buttonsSpecified);</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">' ２つのキー［P］と［M］にボタンの"+"と"-"を設定します。
Dim keysSpecified As Keys() = {Keys.P, Keys.M}
Dim buttonsSpecified As String() = {"+", "-"}
GcCalculator1.ButtonMappings.AddRange(keysSpecified, buttonsSpecified)</code></pre></div><h2>関連トピック</h2><p><a href="gcdocsite__documentlink?toc-item-id=020d253d-f12e-416d-84be-0aabaf1bce55" title="">GcCalculatorコントロール</a></p><p><a href="gcdocsite__documentlink?toc-item-id=4348356e-9217-4cde-8f63-8913552eb24c" title="">書式の設定</a></p><p><a href="gcdocsite__documentlink?toc-item-id=9e0f8245-9dce-4b8a-94c2-15fa3811a763" title="">外観の変更</a></p><p><a href="gcdocsite__documentlink?toc-item-id=884638ab-c590-4ee1-9c1d-a4e00437ac49" title="">キーボードからの操作</a></p><p><a href="gcdocsite__documentlink?toc-item-id=1dbfce79-cd93-4b04-adae-661e9f1e831f" title="">他コントロールとの値の受け渡し</a></p>