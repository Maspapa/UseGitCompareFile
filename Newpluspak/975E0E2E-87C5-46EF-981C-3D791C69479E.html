<p>GcClassicFunctionKey コントロールの操作とイベントについて、以下に解説します。</p><h2>操作とイベント</h2><p><a href="gcdocsite__documentlink?toc-item-id=03022816-c1e2-4ec8-b185-f11edd59c10d#FUNCTIONKEYPRESS" title="">FunctionKeyPress</a>イベントは、GcClassicFunctionKey コントロールの中核をなす機能を提供します。このイベントは、［F1］から［F12］までのファンクションキー、［Home］、［End］、［PageUp］、［PageDown］の各キー、およびこれらのキーと制御キー （［Alt］、［Ctrl］、［Shift］）を組み合わせたキーをキーボード上で押下したとき、または対応するボタンをマウスでクリックしたときに発生します。<a href="gcdocsite__documentlink?toc-item-id=03022816-c1e2-4ec8-b185-f11edd59c10d#FUNCTIONKEYPRESS" title="">FunctionKeyPress</a>イベントのプロシージャに任意のコードを記述することで、ファンクションキー操作時に目的の動作を実現することができます。</p><p>また、<a href="gcdocsite__documentlink?toc-item-id=03022816-c1e2-4ec8-b185-f11edd59c10d#SHIFTSTATEDOWN" title="">ShiftStateDown</a> イベントと <a href="gcdocsite__documentlink?toc-item-id=03022816-c1e2-4ec8-b185-f11edd59c10d#SHIFTSTATEUP" title="">ShiftStateUp</a> イベントを利用することで、［Ctrl］キーなどの制御キーを押下したときに、対象となる動作を切り替えることも可能です。次のサンプルコードは、［Ctrl］キーの押下に合わせてアクティブなキーセットを入れ替える方法を示します。</p><div data-language="csharp" class="toastui-editor-ww-code-block-highlighting"><pre class="language-csharp"><code data-language="csharp" class="language-csharp"><span class="hljs-keyword">using</span> GrapeCity.Win.Bars;

<span class="hljs-function">private void Form1_Load(object sender, System.EventArgs e)</span>
{
    <span class="hljs-comment">// スタイルセットを作成します。</span>
    ThreeDStyleSet aStyle = <span class="hljs-keyword">new</span> ThreeDStyleSet();
    aStyle.AlignHorizontal = AlignHorizontal.Center;
    aStyle.AlignVertical = AlignVertical.Middle;
    gcClassicFunctionKey1.StyleSets.Add(<span class="hljs-string">"styleA"</span>,aStyle);

    <span class="hljs-comment">// 標準のキーセットを作成します。</span>
    <span class="hljs-built_in">int</span> aIndex = gcClassicFunctionKey1.KeySets.Add(<span class="hljs-string">"Normal"</span>);
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">0</span>].Text = <span class="hljs-string">"F1 ヘルプ"</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">1</span>].Text = <span class="hljs-string">"F2"</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">1</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">2</span>].Text = <span class="hljs-string">"F3 定型句挿入"</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">3</span>].Text = <span class="hljs-string">"F4 繰り返し"</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">4</span>].Text = <span class="hljs-string">"F5 ジャンプ"</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">5</span>].Text = <span class="hljs-string">"F6 切り替え"</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">6</span>].Text = <span class="hljs-string">"F7 スペルチェック"</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">7</span>].Text = <span class="hljs-string">"F8"</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">7</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">8</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">8</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">9</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">9</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">10</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">10</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">11</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">11</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">12</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">12</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">13</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">13</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">14</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">14</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">15</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[aIndex][<span class="hljs-number">15</span>].Enabled = <span class="hljs-literal">false</span>;

    <span class="hljs-comment">// Ctrlボタン押下時のキーセットを作成します。</span>
    gcClassicFunctionKey1.KeySets.Add(<span class="hljs-string">"Controled"</span>);
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">0</span>].Text = <span class="hljs-string">"F1"</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">0</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">1</span>].Text = <span class="hljs-string">"F2 印刷プレビュー"</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">2</span>].Text = <span class="hljs-string">"F3 印刷"</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">3</span>].Text = <span class="hljs-string">"F4 移動"</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">4</span>].Text = <span class="hljs-string">"F5 検索"</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">5</span>].Text = <span class="hljs-string">"F6"</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">5</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">6</span>].Text = <span class="hljs-string">"F7"</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">6</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">7</span>].Text = <span class="hljs-string">"F8 サイズ変更"</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">8</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">8</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">9</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">9</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">10</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">10</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">11</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">11</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">12</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">12</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">13</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">13</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">14</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">14</span>].Enabled = <span class="hljs-literal">false</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">15</span>].ButtonIndex = <span class="hljs-number">-1</span>;
    gcClassicFunctionKey1.KeySets[<span class="hljs-string">"Controled"</span>][<span class="hljs-number">15</span>].Enabled = <span class="hljs-literal">false</span>;

    <span class="hljs-comment">// 作成したスタイルセットとキーセットをアクティブにします。</span>
    gcClassicFunctionKey1.ActiveStyleSet = <span class="hljs-string">"styleA"</span>;
    gcClassicFunctionKey1.ActiveKeySet = <span class="hljs-string">"Normal"</span>;
    gcClassicFunctionKey1.ColumnGroups = <span class="hljs-string">"8"</span>;
}

<span class="hljs-function">private void GcClassicFunctionKey1_ShiftStateDown(object sender, System.Windows.Forms.KeyEventArgs e)</span>
{
    <span class="hljs-keyword">if</span> (e.Control == <span class="hljs-literal">true</span>)
    {
        gcClassicFunctionKey1.ActiveKeySet = <span class="hljs-string">"Controled"</span>;
    }
}

<span class="hljs-function">private void gcClassicFunctionKey1_ShiftStateUp(object sender, System.Windows.Forms.KeyEventArgs e)</span>
{
    <span class="hljs-keyword">if</span> (e.Control == <span class="hljs-literal">false</span>)
    {
        gcClassicFunctionKey1.ActiveKeySet = <span class="hljs-string">"Normal"</span>;
    }
}</code></pre></div><div data-language="vbnet" class="toastui-editor-ww-code-block-highlighting"><pre class="language-vbnet"><code data-language="vbnet" class="language-vbnet">Imports GrapeCity.Win.Bars

Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles MyBase.Load
    ' スタイルセットを作成します。
    Dim aStyle As ThreeDStyleSet = New ThreeDStyleSet()
    aStyle.AlignHorizontal = AlignHorizontal.Center
    aStyle.AlignVertical = AlignVertical.Middle
    GcClassicFunctionKey1.StyleSets.Add("styleA", aStyle)

    ' 標準のキーセットを作成します。
    Dim aIndex As Integer = GcClassicFunctionKey1.KeySets.Add("Normal")
    GcClassicFunctionKey1.KeySets(aIndex)(0).Text = "F1 ヘルプ"
    GcClassicFunctionKey1.KeySets(aIndex)(1).Text = "F2"
    GcClassicFunctionKey1.KeySets(aIndex)(1).Enabled = False
    GcClassicFunctionKey1.KeySets(aIndex)(2).Text = "F3 定型句挿入"
    GcClassicFunctionKey1.KeySets(aIndex)(3).Text = "F4 繰り返し"
    GcClassicFunctionKey1.KeySets(aIndex)(4).Text = "F5 ジャンプ"
    GcClassicFunctionKey1.KeySets(aIndex)(5).Text = "F6 切り替え"
    GcClassicFunctionKey1.KeySets(aIndex)(6).Text = "F7 スペルチェック"
    GcClassicFunctionKey1.KeySets(aIndex)(7).Text = "F8"
    GcClassicFunctionKey1.KeySets(aIndex)(7).Enabled = False
    GcClassicFunctionKey1.KeySets(aIndex)(8).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets(aIndex)(8).Enabled = False
    GcClassicFunctionKey1.KeySets(aIndex)(9).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets(aIndex)(9).Enabled = False
    GcClassicFunctionKey1.KeySets(aIndex)(10).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets(aIndex)(10).Enabled = False
    GcClassicFunctionKey1.KeySets(aIndex)(11).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets(aIndex)(11).Enabled = False
    GcClassicFunctionKey1.KeySets(aIndex)(12).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets(aIndex)(12).Enabled = False
    GcClassicFunctionKey1.KeySets(aIndex)(13).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets(aIndex)(13).Enabled = False
    GcClassicFunctionKey1.KeySets(aIndex)(14).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets(aIndex)(14).Enabled = False
    GcClassicFunctionKey1.KeySets(aIndex)(15).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets(aIndex)(15).Enabled = False

    ' Ctrlボタン押下時のキーセットを作成します。
    GcClassicFunctionKey1.KeySets.Add("Controled")
    GcClassicFunctionKey1.KeySets("Controled")(0).Text = "F1"
    GcClassicFunctionKey1.KeySets("Controled")(0).Enabled = False
    GcClassicFunctionKey1.KeySets("Controled")(1).Text = "F2 印刷プレビュー"
    GcClassicFunctionKey1.KeySets("Controled")(2).Text = "F3 印刷"
    GcClassicFunctionKey1.KeySets("Controled")(3).Text = "F4 移動"
    GcClassicFunctionKey1.KeySets("Controled")(4).Text = "F5 検索"
    GcClassicFunctionKey1.KeySets("Controled")(5).Text = "F6"
    GcClassicFunctionKey1.KeySets("Controled")(5).Enabled = False
    GcClassicFunctionKey1.KeySets("Controled")(6).Text = "F7"
    GcClassicFunctionKey1.KeySets("Controled")(6).Enabled = False
    GcClassicFunctionKey1.KeySets("Controled")(7).Text = "F8 サイズ変更"
    GcClassicFunctionKey1.KeySets("Controled")(8).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets("Controled")(8).Enabled = False
    GcClassicFunctionKey1.KeySets("Controled")(9).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets("Controled")(9).Enabled = False
    GcClassicFunctionKey1.KeySets("Controled")(10).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets("Controled")(10).Enabled = False
    GcClassicFunctionKey1.KeySets("Controled")(11).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets("Controled")(11).Enabled = False
    GcClassicFunctionKey1.KeySets("Controled")(12).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets("Controled")(12).Enabled = False
    GcClassicFunctionKey1.KeySets("Controled")(13).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets("Controled")(13).Enabled = False
    GcClassicFunctionKey1.KeySets("Controled")(14).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets("Controled")(14).Enabled = False
    GcClassicFunctionKey1.KeySets("Controled")(15).ButtonIndex = -1
    GcClassicFunctionKey1.KeySets("Controled")(15).Enabled = False

    ' 作成したスタイルセットとキーセットをアクティブにします。
    GcClassicFunctionKey1.ActiveStyleSet = "styleA"
    GcClassicFunctionKey1.ActiveKeySet = "Normal"
    GcClassicFunctionKey1.ColumnGroups = "8"
End Sub

Private Sub GcClassicFunctionKey1_ShiftStateDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles GcClassicFunctionKey1.ShiftStateUp
    If e.Control = True Then
        GcClassicFunctionKey1.ActiveKeySet = "Controled"
    End If
End Sub

Private Sub GcClassicFunctionKey1_ShiftStateUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles GcClassicFunctionKey1.ShiftStateUp
    If e.Control = False Then
        GcClassicFunctionKey1.ActiveKeySet = "Normal"
    End If
End Sub</code></pre></div><p>さらに、<a href="gcdocsite__documentlink?toc-item-id=03022816-c1e2-4ec8-b185-f11edd59c10d#INTERACTIVEMOUSE" title="">InteractiveMouse</a> プロパティをFalseに設定すると、マウスによるボタンクリックを禁止し、キーボード操作のみを対象にできます。<a href="gcdocsite__documentlink?toc-item-id=03022816-c1e2-4ec8-b185-f11edd59c10d#KEYREPEAT" title="">KeyRepeat</a> プロパティは、キーを押し続けている間、FunctionKeyPress イベントを繰り返し発生させるかどうかを指定します。</p><h2>関連トピック</h2><p><a href="gcdocsite__documentlink?toc-item-id=657de385-26c7-4db1-ab0f-f6f30e8a6d65" title="">GcClassicFunctionKeyコントロール</a></p><p><a href="gcdocsite__documentlink?toc-item-id=23bb6719-ede0-43b2-b30e-476931ebbca1" title="">外観の設定</a></p><p><a href="gcdocsite__documentlink?toc-item-id=e4fe7d2e-e79f-440e-a26a-5b4100a71843" title="">ボタン全体のスタイル設定</a></p><p><a href="gcdocsite__documentlink?toc-item-id=48abf538-16d3-4172-9f1a-1d94f94df2c3" title="">個々のボタン設定</a></p>